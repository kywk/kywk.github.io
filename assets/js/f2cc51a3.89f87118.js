"use strict";(self.webpackChunkkywk_me=self.webpackChunkkywk_me||[]).push([["15636"],{4857:function(e,n,r){r.r(n),r.d(n,{frontMatter:()=>a,toc:()=>d,default:()=>h,metadata:()=>i,assets:()=>o,contentTitle:()=>l});var i=JSON.parse('{"id":"DevSecOps/Infrastructure/Nginx Modify Endpoint","title":"NGINX: changes URI","description":"NGINX changes endpoint","source":"@site/moco/DevSecOps/Infrastructure/Nginx Modify Endpoint.md","sourceDirName":"DevSecOps/Infrastructure","slug":"/devsecops/infrastructure/nginx-modify-endpoint/","permalink":"/moco/devsecops/infrastructure/nginx-modify-endpoint/","draft":false,"unlisted":false,"tags":[{"inline":true,"label":"Infrastructure","permalink":"/moco/tags/infrastructure"},{"inline":true,"label":"NGINX","permalink":"/moco/tags/nginx"}],"version":"current","frontMatter":{"title":"NGINX: changes URI","description":"NGINX changes endpoint","tags":["Infrastructure","NGINX"],"hide_table_of_contents":true,"date_created":"2023-01-04T00:00:00.000Z","date_updated":"2023-01-04T00:00:00.000Z","image":"https://lh3.googleusercontent.com/pw/AL9nZEUA9Ifvd5Z8SXDWkeVB6AC4MPGwnXaL6kBXNPoXwOQQ2jOcZ1Jw_0p8TKK8C3ZX0e67_FOY15eDrm7aaXSQJcKtoUzC80SAQEHsaBy6qS2AqNNs5VUFNXBKm439y_1wkvmDl-PnL8ReojnIumNlEvOXBg=w800-no?authuser=0","slug":"/devsecops/infrastructure/nginx-modify-endpoint/"},"sidebar":"tutorialSidebar","previous":{"title":"NGINX: Let\'s Encrypt SSL","permalink":"/moco/devsecops/infrastructure/nginx-lets-encrypt-ssl/"},"next":{"title":"Redis: Cluster \u5EFA\u88FD","permalink":"/moco/devsecops/infrastructure/redis-cluster/"}}'),t=r(74848),s=r(84429);let a={title:"NGINX: changes URI",description:"NGINX changes endpoint",tags:["Infrastructure","NGINX"],hide_table_of_contents:!0,date_created:new Date("2023-01-04T00:00:00.000Z"),date_updated:new Date("2023-01-04T00:00:00.000Z"),image:"https://lh3.googleusercontent.com/pw/AL9nZEUA9Ifvd5Z8SXDWkeVB6AC4MPGwnXaL6kBXNPoXwOQQ2jOcZ1Jw_0p8TKK8C3ZX0e67_FOY15eDrm7aaXSQJcKtoUzC80SAQEHsaBy6qS2AqNNs5VUFNXBKm439y_1wkvmDl-PnL8ReojnIumNlEvOXBg=w800-no?authuser=0",slug:"/devsecops/infrastructure/nginx-modify-endpoint/"},l="[NGINX] URL redirect / rewrite / proxy_pass",o={},d=[{value:"Summary",id:"summary",level:2},{value:"Best Practices",id:"best-practices",level:2},{value:"\u4F7F\u7528\u60C5\u5883\u9078\u64C7",id:"\u4F7F\u7528\u60C5\u5883\u9078\u64C7",level:3},{value:"\u6548\u80FD\u8003\u91CF",id:"\u6548\u80FD\u8003\u91CF",level:3},{value:"\u5B89\u5168\u6027\u5EFA\u8B70",id:"\u5B89\u5168\u6027\u5EFA\u8B70",level:3},{value:"\u7DAD\u8B77\u6027\u539F\u5247",id:"\u7DAD\u8B77\u6027\u539F\u5247",level:3},{value:"Redirect (301/302)",id:"redirect-301302",level:2},{value:"Basic Redirects",id:"basic-redirects",level:3},{value:"Conditional Redirects",id:"conditional-redirects",level:3},{value:"Rewrite Rules",id:"rewrite-rules",level:2},{value:"Basic Rewrite",id:"basic-rewrite",level:3},{value:"Advanced Rewrite Patterns",id:"advanced-rewrite-patterns",level:3},{value:"Proxy Pass",id:"proxy-pass",level:2},{value:"Basic Proxy",id:"basic-proxy",level:3},{value:"Proxy with Headers",id:"proxy-with-headers",level:3},{value:"Load Balancing",id:"load-balancing",level:3},{value:"Combined Techniques",id:"combined-techniques",level:2},{value:"Rewrite + Proxy",id:"rewrite--proxy",level:3},{value:"Path-based Routing",id:"path-based-routing",level:3},{value:"Common Patterns",id:"common-patterns",level:2},{value:"API Versioning",id:"api-versioning",level:3},{value:"Subdomain Routing",id:"subdomain-routing",level:3},{value:"Mobile Detection",id:"mobile-detection",level:3},{value:"Troubleshooting",id:"troubleshooting",level:2},{value:"Debug Rewrite Rules",id:"debug-rewrite-rules",level:3},{value:"Common Issues",id:"common-issues",level:3},{value:"See Also",id:"see-also",level:2}];function c(e){let n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,s.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"nginx-url-redirect--rewrite--proxy_pass",children:"[NGINX] URL redirect / rewrite / proxy_pass"})}),"\n",(0,t.jsx)(n.h2,{id:"summary",children:"Summary"}),"\n",(0,t.jsx)(n.p,{children:"Nginx \u63D0\u4F9B\u4E09\u7A2E\u4E3B\u8981\u7684 URL \u4FEE\u6539\u65B9\u6CD5\uFF1A"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Redirect (301/302)"}),": \u700F\u89BD\u5668\u91CD\u5B9A\u5411\uFF0CURL \u6703\u6539\u8B8A\uFF0C\u9069\u7528\u65BC\u7DB2\u7AD9\u9077\u79FB\u3001SEO \u512A\u5316"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Rewrite"}),": \u4F3A\u670D\u5668\u5167\u90E8\u91CD\u5BEB\uFF0CURL \u4E0D\u8B8A\uFF0C\u9069\u7528\u65BC URL \u7F8E\u5316\u3001\u8DEF\u7531\u8655\u7406"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Proxy Pass"}),": \u53CD\u5411\u4EE3\u7406\u8F49\u767C\uFF0C\u9069\u7528\u65BC\u5FAE\u670D\u52D9\u67B6\u69CB\u3001\u8CA0\u8F09\u5E73\u8861"]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"best-practices",children:"Best Practices"}),"\n",(0,t.jsx)(n.h3,{id:"\u4F7F\u7528\u60C5\u5883\u9078\u64C7",children:"\u4F7F\u7528\u60C5\u5883\u9078\u64C7"}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"\u65B9\u6CD5"}),(0,t.jsx)(n.th,{children:"\u4F7F\u7528\u6642\u6A5F"}),(0,t.jsx)(n.th,{children:"\u512A\u9EDE"}),(0,t.jsx)(n.th,{children:"\u7F3A\u9EDE"})]})}),(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.strong,{children:"Redirect"})}),(0,t.jsx)(n.td,{children:"\u7DB2\u7AD9\u9077\u79FB\u3001\u5F37\u5236 HTTPS\u3001SEO \u91CD\u5B9A\u5411"}),(0,t.jsx)(n.td,{children:"\u700F\u89BD\u5668\u5FEB\u53D6\u3001SEO \u53CB\u5584"}),(0,t.jsx)(n.td,{children:"\u984D\u5916 HTTP \u8ACB\u6C42"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.strong,{children:"Rewrite"})}),(0,t.jsx)(n.td,{children:"URL \u7F8E\u5316\u3001\u5167\u90E8\u8DEF\u7531\u3001\u53C3\u6578\u8F49\u63DB"}),(0,t.jsx)(n.td,{children:"\u900F\u660E\u8655\u7406\u3001\u6548\u80FD\u4F73"}),(0,t.jsx)(n.td,{children:"\u9664\u932F\u56F0\u96E3"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.strong,{children:"Proxy Pass"})}),(0,t.jsx)(n.td,{children:"\u5FAE\u670D\u52D9\u3001\u8CA0\u8F09\u5E73\u8861\u3001API Gateway"}),(0,t.jsx)(n.td,{children:"\u9748\u6D3B\u8DEF\u7531\u3001\u670D\u52D9\u5206\u96E2"}),(0,t.jsx)(n.td,{children:"\u7DB2\u8DEF\u5EF6\u9072"})]})]})]}),"\n",(0,t.jsx)(n.h3,{id:"\u6548\u80FD\u8003\u91CF",children:"\u6548\u80FD\u8003\u91CF"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-nginx",children:"# \u512A\u5148\u4F7F\u7528 return \u800C\u975E rewrite \u9032\u884C\u91CD\u5B9A\u5411\n# GOOD - \u6548\u80FD\u8F03\u4F73\nlocation /old-site {\n    return 301 https://new-site.com$request_uri;\n}\n\n# AVOID - \u6548\u80FD\u8F03\u5DEE\nlocation /old-site {\n    rewrite ^(.*)$ https://new-site.com$1 permanent;\n}\n"})}),"\n",(0,t.jsx)(n.h3,{id:"\u5B89\u5168\u6027\u5EFA\u8B70",children:"\u5B89\u5168\u6027\u5EFA\u8B70"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-nginx",children:'# \u9650\u5236 rewrite \u898F\u5247\u7684\u8907\u96DC\u5EA6\nlocation ~ ^/user/([a-zA-Z0-9_-]+)$ {\n    # \u4F7F\u7528\u56B4\u683C\u7684\u6B63\u5247\u8868\u9054\u5F0F\n    rewrite ^/user/([a-zA-Z0-9_-]+)$ /profile.php?user=$1 last;\n}\n\n# \u907F\u514D\u5728 if \u4E2D\u4F7F\u7528\u8907\u96DC\u908F\u8F2F\n# \u4F7F\u7528 map \u66FF\u4EE3\u8907\u96DC\u7684 if \u5224\u65B7\nmap $request_uri $new_uri {\n    ~^/old/(.+)$ /new/$1;\n    default "";\n}\n'})}),"\n",(0,t.jsx)(n.h3,{id:"\u7DAD\u8B77\u6027\u539F\u5247",children:"\u7DAD\u8B77\u6027\u539F\u5247"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-nginx",children:"# \u4F7F\u7528\u8A3B\u89E3\u8AAA\u660E\u8907\u96DC\u898F\u5247\nlocation /api {\n    # \u5C07 v1 API \u91CD\u5B9A\u5411\u5230 v2\uFF0C\u4FDD\u6301\u5411\u5F8C\u76F8\u5BB9\n    rewrite ^/api/v1/(.*)$ /api/v2/$1 last;\n    proxy_pass http://api-backend;\n}\n\n# \u5C07\u76F8\u95DC\u898F\u5247\u5206\u7D44\n# API \u8DEF\u7531\nlocation /api/v1 { proxy_pass http://api-v1; }\nlocation /api/v2 { proxy_pass http://api-v2; }\n\n# \u975C\u614B\u8CC7\u6E90\nlocation /assets { expires 1y; }\nlocation /images { expires 30d; }\n"})}),"\n",(0,t.jsx)(n.h2,{id:"redirect-301302",children:"Redirect (301/302)"}),"\n",(0,t.jsx)(n.p,{children:"\u91CD\u5B9A\u5411\u662F\u5C07\u7528\u6236\u8ACB\u6C42\u5C0E\u5411\u5230\u4E0D\u540C\u7684 URL\uFF0C\u700F\u89BD\u5668\u6703\u986F\u793A\u65B0\u7684\u7DB2\u5740\u3002"}),"\n",(0,t.jsx)(n.h3,{id:"basic-redirects",children:"Basic Redirects"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-nginx",children:"# Permanent redirect (301) - \u6C38\u4E45\u91CD\u5B9A\u5411\nserver {\n    listen 80;\n    server_name old-domain.com;\n    return 301 https://new-domain.com$request_uri;\n}\n\n# Temporary redirect (302) - \u81E8\u6642\u91CD\u5B9A\u5411\nlocation /old-path {\n    return 302 /new-path;\n}\n\n# Redirect with query parameters - \u4FDD\u7559\u67E5\u8A62\u53C3\u6578\u7684\u91CD\u5B9A\u5411\nlocation /search {\n    return 301 /new-search?$args;\n}\n"})}),"\n",(0,t.jsx)(n.h3,{id:"conditional-redirects",children:"Conditional Redirects"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-nginx",children:'# Redirect based on user agent - \u6839\u64DA\u7528\u6236\u4EE3\u7406\u91CD\u5B9A\u5411\nif ($http_user_agent ~* "bot|crawler|spider") {\n    return 301 /robots.txt;\n}\n\n# Redirect based on request method - \u6839\u64DA\u8ACB\u6C42\u65B9\u6CD5\u91CD\u5B9A\u5411\nif ($request_method = POST) {\n    return 405;\n}\n\n# Redirect HTTP to HTTPS - HTTP \u5F37\u5236\u8F49 HTTPS\nif ($scheme != "https") {\n    return 301 https://$server_name$request_uri;\n}\n'})}),"\n",(0,t.jsx)(n.h2,{id:"rewrite-rules",children:"Rewrite Rules"}),"\n",(0,t.jsx)(n.p,{children:"\u91CD\u5BEB\u898F\u5247\u662F\u5728\u4F3A\u670D\u5668\u5167\u90E8\u4FEE\u6539 URL\uFF0C\u4E0D\u6703\u6539\u8B8A\u700F\u89BD\u5668\u4E2D\u7684\u7DB2\u5740\u3002"}),"\n",(0,t.jsx)(n.h3,{id:"basic-rewrite",children:"Basic Rewrite"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-nginx",children:"# Simple rewrite - \u7C21\u55AE\u91CD\u5BEB\nlocation /old {\n    rewrite ^/old/(.*)$ /new/$1 last;\n}\n\n# Rewrite with break - \u4F7F\u7528 break \u505C\u6B62\u7E7C\u7E8C\u8655\u7406\nlocation /api {\n    rewrite ^/api/v1/(.*)$ /v2/$1 break;\n    proxy_pass http://backend;\n}\n\n# Internal rewrite (no redirect) - \u5167\u90E8\u91CD\u5BEB\uFF08\u4E0D\u91CD\u5B9A\u5411\uFF09\nlocation /products {\n    rewrite ^/products/([0-9]+)$ /product.php?id=$1 last;\n}\n"})}),"\n",(0,t.jsx)(n.h3,{id:"advanced-rewrite-patterns",children:"Advanced Rewrite Patterns"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-nginx",children:"# Multiple capture groups - \u591A\u500B\u6355\u7372\u7FA4\u7D44\nlocation /user {\n    rewrite ^/user/([^/]+)/profile/([0-9]+)$ /profile.php?user=$1&id=$2 last;\n}\n\n# Optional parameters - \u53EF\u9078\u53C3\u6578\nlocation /blog {\n    rewrite ^/blog/([0-9]{4})/([0-9]{2})/(.+)$ /blog.php?year=$1&month=$2&slug=$3 last;\n    rewrite ^/blog/(.+)$ /blog.php?slug=$1 last;\n}\n\n# Case insensitive matching - \u4E0D\u5340\u5206\u5927\u5C0F\u5BEB\u7684\u5339\u914D\nlocation ~* /API {\n    rewrite ^/api/(.*)$ /api.php?path=$1 last;\n}\n"})}),"\n",(0,t.jsx)(n.h2,{id:"proxy-pass",children:"Proxy Pass"}),"\n",(0,t.jsx)(n.p,{children:"\u4EE3\u7406\u8F49\u767C\u662F\u5C07\u8ACB\u6C42\u8F49\u767C\u5230\u5F8C\u7AEF\u4F3A\u670D\u5668\uFF0C\u5E38\u7528\u65BC\u53CD\u5411\u4EE3\u7406\u548C\u8CA0\u8F09\u5E73\u8861\u3002"}),"\n",(0,t.jsx)(n.h3,{id:"basic-proxy",children:"Basic Proxy"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-nginx",children:"# Simple proxy - \u7C21\u55AE\u4EE3\u7406\nlocation /api {\n    proxy_pass http://backend-server:8080;\n}\n\n# Proxy with path modification - \u4FEE\u6539\u8DEF\u5F91\u7684\u4EE3\u7406\nlocation /api/v1/ {\n    proxy_pass http://backend-server:8080/;\n}\n\n# Proxy to different path - \u4EE3\u7406\u5230\u4E0D\u540C\u8DEF\u5F91\nlocation /old-api/ {\n    proxy_pass http://backend-server:8080/new-api/;\n}\n"})}),"\n",(0,t.jsx)(n.h3,{id:"proxy-with-headers",children:"Proxy with Headers"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-nginx",children:"# \u8A2D\u5B9A\u4EE3\u7406\u6A19\u982D\uFF0C\u4FDD\u7559\u539F\u59CB\u8ACB\u6C42\u8CC7\u8A0A\nlocation /api {\n    proxy_pass http://backend;\n    proxy_set_header Host $host;\n    proxy_set_header X-Real-IP $remote_addr;\n    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n    proxy_set_header X-Forwarded-Proto $scheme;\n}\n"})}),"\n",(0,t.jsx)(n.h3,{id:"load-balancing",children:"Load Balancing"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-nginx",children:"# \u5B9A\u7FA9\u4E0A\u6E38\u4F3A\u670D\u5668\u7FA4\u7D44\nupstream backend {\n    server backend1.example.com:8080;\n    server backend2.example.com:8080;\n    server backend3.example.com:8080;\n}\n\n# \u4F7F\u7528\u8CA0\u8F09\u5E73\u8861\nlocation /api {\n    proxy_pass http://backend;\n}\n"})}),"\n",(0,t.jsx)(n.h2,{id:"combined-techniques",children:"Combined Techniques"}),"\n",(0,t.jsx)(n.p,{children:"\u7D44\u5408\u6280\u8853\u53EF\u4EE5\u540C\u6642\u4F7F\u7528\u591A\u7A2E\u65B9\u6CD5\u4F86\u8655\u7406\u8907\u96DC\u7684\u8DEF\u7531\u9700\u6C42\u3002"}),"\n",(0,t.jsx)(n.h3,{id:"rewrite--proxy",children:"Rewrite + Proxy"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-nginx",children:"# Rewrite then proxy - \u5148\u91CD\u5BEB\u518D\u4EE3\u7406\nlocation /old-api {\n    rewrite ^/old-api/(.*)$ /new-api/$1 break;\n    proxy_pass http://backend-server;\n}\n\n# Multiple rewrites with proxy - \u591A\u91CD\u91CD\u5BEB\u642D\u914D\u4EE3\u7406\nlocation /service {\n    rewrite ^/service/v1/(.*)$ /api/v2/$1 break;\n    rewrite ^/service/legacy/(.*)$ /api/v1/$1 break;\n    proxy_pass http://backend;\n}\n"})}),"\n",(0,t.jsx)(n.h3,{id:"path-based-routing",children:"Path-based Routing"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-nginx",children:"# Route different paths to different backends - \u6839\u64DA\u8DEF\u5F91\u8DEF\u7531\u5230\u4E0D\u540C\u5F8C\u7AEF\nlocation /auth/ {\n    proxy_pass http://auth-service/;\n}\n\nlocation /users/ {\n    proxy_pass http://user-service/;\n}\n\nlocation /orders/ {\n    proxy_pass http://order-service/;\n}\n"})}),"\n",(0,t.jsx)(n.h2,{id:"common-patterns",children:"Common Patterns"}),"\n",(0,t.jsx)(n.p,{children:"\u5E38\u898B\u7684\u61C9\u7528\u6A21\u5F0F\u548C\u5BE6\u52D9\u4E0A\u7684\u4F7F\u7528\u60C5\u5883\u3002"}),"\n",(0,t.jsx)(n.h3,{id:"api-versioning",children:"API Versioning"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-nginx",children:"# Default to latest version - \u9810\u8A2D\u4F7F\u7528\u6700\u65B0\u7248\u672C\nlocation /api {\n    rewrite ^/api/(.*)$ /api/v2/$1 last;\n}\n\n# Specific version routing - \u7279\u5B9A\u7248\u672C\u8DEF\u7531\nlocation /api/v1 {\n    proxy_pass http://api-v1-backend;\n}\n\nlocation /api/v2 {\n    proxy_pass http://api-v2-backend;\n}\n"})}),"\n",(0,t.jsx)(n.h3,{id:"subdomain-routing",children:"Subdomain Routing"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-nginx",children:"# Route subdomains to different paths - \u5B50\u7DB2\u57DF\u8DEF\u7531\nserver {\n    server_name ~^(?<subdomain>.+)\\.example\\.com$;\n    location / {\n        proxy_pass http://backend/$subdomain;\n    }\n}\n"})}),"\n",(0,t.jsx)(n.h3,{id:"mobile-detection",children:"Mobile Detection"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-nginx",children:'# Redirect mobile users - \u884C\u52D5\u88DD\u7F6E\u5075\u6E2C\u8207\u91CD\u5B9A\u5411\nset $mobile_rewrite do_not_perform;\n\nif ($http_user_agent ~* "(android|bb\\d+|meego).+mobile|avantgo|bada/") {\n    set $mobile_rewrite perform;\n}\n\nif ($mobile_rewrite = perform) {\n    rewrite ^ https://m.example.com$request_uri redirect;\n}\n'})}),"\n",(0,t.jsx)(n.h2,{id:"troubleshooting",children:"Troubleshooting"}),"\n",(0,t.jsx)(n.p,{children:"\u9664\u932F\u548C\u5E38\u898B\u554F\u984C\u7684\u89E3\u6C7A\u65B9\u6CD5\u3002"}),"\n",(0,t.jsx)(n.h3,{id:"debug-rewrite-rules",children:"Debug Rewrite Rules"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-nginx",children:"# Enable rewrite log - \u555F\u7528\u91CD\u5BEB\u65E5\u8A8C\nerror_log /var/log/nginx/error.log notice;\nrewrite_log on;\n\n# Test configuration - \u6E2C\u8A66\u914D\u7F6E\n# nginx -t\n"})}),"\n",(0,t.jsx)(n.h3,{id:"common-issues",children:"Common Issues"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-nginx",children:"# Avoid infinite loops - \u907F\u514D\u7121\u9650\u8FF4\u5708\nlocation /redirect {\n    # BAD: causes infinite loop - \u932F\u8AA4\uFF1A\u9020\u6210\u7121\u9650\u8FF4\u5708\n    # rewrite ^/redirect/(.*)$ /redirect/new/$1 last;\n    \n    # GOOD: use different path - \u6B63\u78BA\uFF1A\u4F7F\u7528\u4E0D\u540C\u8DEF\u5F91\n    rewrite ^/redirect/(.*)$ /new-redirect/$1 last;\n}\n\n# Handle trailing slashes - \u8655\u7406\u7D50\u5C3E\u659C\u7DDA\nlocation /api {\n    rewrite ^/api/(.*)$ /api/$1/ last;\n    proxy_pass http://backend/;\n}\n"})}),"\n",(0,t.jsx)(n.h2,{id:"see-also",children:"See Also"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"https://www.nginx.com/blog/creating-nginx-rewrite-rules/",children:"How to Create NGINX Rewrite Rules | NGINX"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"https://www.digitalocean.com/community/tutorials/nginx-rewrite-url-rules",children:"Nginx Rewrite URL Rules Examples | DigitalOcean"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"https://serverfault.com/questions/379675/nginx-reverse-proxy-url-rewrite",children:"Nginx reverse proxy + URL rewrite - Server Fault"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"https://magiclen.org/nginx-rewrite/",children:"Nginx\u5982\u4F55\u9032\u884C\u8F49\u5740\uFF1F | MagicLen"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"https://ubiq.co/tech-blog/rewrite-vs-redirect-nginx/",children:"Rewrite vs Redirect NGINX - Ubiq BI"})}),"\n"]})]})}function h(e={}){let{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(c,{...e})}):c(e)}},84429:function(e,n,r){r.d(n,{R:()=>a,x:()=>l});var i=r(96540);let t={},s=i.createContext(t);function a(e){let n=i.useContext(s);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:a(e.components),i.createElement(s.Provider,{value:n},e.children)}}}]);