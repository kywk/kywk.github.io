"use strict";(self.webpackChunkkywk_me=self.webpackChunkkywk_me||[]).push([["57568"],{27522:function(e,n,i){i.r(n),i.d(n,{metadata:()=>r,contentTitle:()=>c,default:()=>d,assets:()=>s,toc:()=>l,frontMatter:()=>a});var r=JSON.parse('{"id":"java/springboot/misc_dockerize","title":"Dockerize","description":"Dockerize Spring Boot application","source":"@site/moco/java/springboot/misc_dockerize.md","sourceDirName":"java/springboot","slug":"/java/springboot/misc_dockerize","permalink":"/moco/java/springboot/misc_dockerize","draft":false,"unlisted":false,"tags":[{"inline":true,"label":"SpringBoot","permalink":"/moco/tags/spring-boot"},{"inline":true,"label":"Docker","permalink":"/moco/tags/docker"}],"version":"current","sidebarPosition":80,"frontMatter":{"title":"Dockerize","description":"Dockerize Spring Boot application","tags":["SpringBoot","Docker"],"sidebar_position":80,"hide_table_of_contents":true,"date_created":"2023-03-14T00:00:00.000Z","date_updated":"2023-03-14T00:00:00.000Z","image":"https://lh3.googleusercontent.com/pw/AL9nZEUA9Ifvd5Z8SXDWkeVB6AC4MPGwnXaL6kBXNPoXwOQQ2jOcZ1Jw_0p8TKK8C3ZX0e67_FOY15eDrm7aaXSQJcKtoUzC80SAQEHsaBy6qS2AqNNs5VUFNXBKm439y_1wkvmDl-PnL8ReojnIumNlEvOXBg=w800-no?authuser=0"},"sidebar":"tutorialSidebar","previous":{"title":"Docker versioning","permalink":"/moco/java/springboot/misc_docker-versioning"},"next":{"title":"SpEL expressions","permalink":"/moco/java/springboot/spring/spring_spel-expressions"}}'),o=i("85893"),t=i("50065");let a={title:"Dockerize",description:"Dockerize Spring Boot application",tags:["SpringBoot","Docker"],sidebar_position:80,hide_table_of_contents:!0,date_created:new Date("2023-03-14T00:00:00.000Z"),date_updated:new Date("2023-03-14T00:00:00.000Z"),image:"https://lh3.googleusercontent.com/pw/AL9nZEUA9Ifvd5Z8SXDWkeVB6AC4MPGwnXaL6kBXNPoXwOQQ2jOcZ1Jw_0p8TKK8C3ZX0e67_FOY15eDrm7aaXSQJcKtoUzC80SAQEHsaBy6qS2AqNNs5VUFNXBKm439y_1wkvmDl-PnL8ReojnIumNlEvOXBg=w800-no?authuser=0"},c="[SpringBoot] Dockerize Spring Boot Application",s={},l=[{value:"Run w/ Java source",id:"run-w-java-source",level:2},{value:"Run w/ JAR binary",id:"run-w-jar-binary",level:2},{value:"Multi-Stage Build",id:"multi-stage-build",level:2},{value:"See Also",id:"see-also",level:2}];function p(e){let n={a:"a",blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,t.a)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(n.header,{children:(0,o.jsx)(n.h1,{id:"springboot-dockerize-spring-boot-application",children:"[SpringBoot] Dockerize Spring Boot Application"})}),"\n",(0,o.jsx)(n.p,{children:"\u5EFA\u7ACB Sprint Boot Application Container \u4E0D\u5916\u4E4E\u5169\u7A2E\u65B9\u5F0F:"}),"\n",(0,o.jsxs)(n.ol,{children:["\n",(0,o.jsx)(n.li,{children:"\u628A\u539F\u59CB\u78BC\u653E\u5165 container, \u900F\u904E mvn \u5728 container \u8DD1."}),"\n",(0,o.jsx)(n.li,{children:"\u628A Sprint Boot \u7DE8\u8B6F\u6210 .jar \u6A94\u5F8C\u653E\u5165 Container, \u900F\u904E Java \u4F86\u57F7\u884C."}),"\n"]}),"\n",(0,o.jsx)(n.h2,{id:"run-w-java-source",children:"Run w/ Java source"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-dockerfile",children:'FROM eclipse-temurin\nWORKDIR /app\n \nCOPY .mvn/ .mvn\nCOPY mvnw pom.xml ./\nRUN ./mvnw dependency:go-offline\n \nCOPY src ./src\n \nCMD ["./mvnw", "spring-boot:run"]\n'})}),"\n",(0,o.jsx)(n.p,{children:"\u9019\u500B Dockerfile \u628A source code \u6253\u5305\u9032 container \u521D\u59CB\u5316\u5C08\u6848\u6A94\u6848\u5F8C,\n\u900F\u904E mvn \u4F86\u7DE8\u8B6F\u8207\u555F\u52D5 sprint boot application."}),"\n",(0,o.jsx)(n.p,{children:"\u9019\u6A23\u7684 image \u9700\u8981\u628A\u5B8C\u6574\u7DE8\u8B6F\u74B0\u5883\u548C\u7A0B\u5F0F\u90FD\u653E\u5165 container \u4E2D,\n\u512A\u9EDE\u662F\u82E5 CI/CD \u74B0\u5883\u4E2D\u6C92\u6709 JDK \u74B0\u5883, \u4ECD\u53EF\u7DE8\u8B6F\u51FA\u53EF\u4EE5\u6B63\u5E38\u57F7\u884C\u7684 Spring Boot container."}),"\n",(0,o.jsx)(n.p,{children:"\u4F46\u4E00\u822C\u4F86\u8AAA, \u9664\u975E\u90E8\u5C6C\u57F7\u884C container \u74B0\u5883\u90FD\u662F\u81EA\u5BB6\u63A7\u7BA1\u7684, \u5426\u5247\u4E0D\u6703\u63A1\u7528\u9019\u7A2E\u65B9\u5F0F.\n\u7562\u7ADF container \u4E2D\u6A94\u6848\u662F\u7121\u6CD5\u88AB\u4FDD\u8B77, \u539F\u59CB\u78BC\u653E\u5165 container \u90E8\u5C6C\u51FA\u53BB, \u7B49\u65BC\u7A0B\u5F0F\u88F8\u5954\u5728\u5916.\n\u82E5\u7A0B\u5F0F\u6709\u91CD\u8981\u5546\u52D9\u908F\u8F2F\u6216\u52A0\u89E3\u5BC6\u8CC7\u8A0A, \u662F\u76F8\u7576\u5371\u96AA\u7684."}),"\n",(0,o.jsxs)(n.p,{children:["Ref: ",(0,o.jsx)(n.a,{href:"https://dhruv-saksena.medium.com/build-deploy-a-spring-boot-application-in-docker-container-49b9b2d3e25e",children:"Build & Deploy a Spring Boot application in Docker container | by Dhruv Saksena | Medium"})]}),"\n",(0,o.jsx)(n.h2,{id:"run-w-jar-binary",children:"Run w/ JAR binary"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-dockerfile",children:'FROM openjdk:11-jdk-alpine\nVOLUME /tmp\nARG JAR_FILE\nCOPY ${JAR_FILE} app.jar\nENTRYPOINT ["java","-jar","/app.jar"]\n'})}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-shell",children:"mvn install dockerfile:build\n"})}),"\n",(0,o.jsx)(n.p,{children:"\u76F8\u5C0D\u65BC\u524D\u8005, \u9019\u500B\u65B9\u5F0F\u662F\u5148\u628A Java \u7DE8\u8B6F\u6210 JAR \u6A94,\n\u9700\u6E96\u5099\u57FA\u672C\u7684 Java runtime container,\n\u628A JAR \u653E\u5165 container \u4E2D\u5373\u53EF\u57F7\u884C."}),"\n",(0,o.jsx)(n.p,{children:"\u82E5\u8981\u90E8\u5C6C\u5230\u5916\u90E8\u74B0\u5883, \u7DE8\u8B6F\u5F8C\u7684 binary \u8F03\u4E0D\u5BB9\u6613\u88AB\u7834\u89E3."}),"\n",(0,o.jsx)(n.p,{children:"\u4F46\u82E5\u8981\u5728 CI/CD \u4E2D\u6253\u5305 container, \u5247\u9700\u78BA\u5B9A CI/CD runner \u4E0A\u662F\u6B63\u78BA\u5C0D\u61C9 JDK \u7248\u672C.\n\u53EF\u80FD\u4E0D\u540C\u5C08\u6848\u4F7F\u7528\u4E86\u4E0D\u540C JDK \u6216 mvn \u7248\u672C, \u9020\u6210 CI/CD \u8A2D\u5B9A\u4E0A\u7684\u8907\u96DC\u6216\u51FA\u932F."}),"\n",(0,o.jsx)(n.p,{children:"\u4E0D\u8003\u616E CI/CD \u60C5\u6CC1, \u7531 develop \u624B\u52D5 build docker image \u7684\u8A71, \u9019\u662F\u9069\u5408\u7684\u65B9\u5F0F."}),"\n",(0,o.jsx)(n.h2,{id:"multi-stage-build",children:"Multi-Stage Build"}),"\n",(0,o.jsxs)(n.blockquote,{children:["\n",(0,o.jsxs)(n.p,{children:[(0,o.jsx)(n.a,{href:"https://docs.docker.com/build/building/multi-stage/",children:"Multi-stage builds"})," are useful to anyone who has struggled to optimize\n",(0,o.jsx)(n.strong,{children:"Dockerfiles"})," while keeping them easy to read and maintain."]}),"\n"]}),"\n",(0,o.jsx)(n.p,{children:"Docker \u652F\u63F4 Multi-Stage Build, \u53EF\u4EE5\u628A\u4E0D\u540C\u968E\u6BB5\u7684\u9700\u6C42\u62C6\u958B\u5230\u5728\u4E0D\u540C docker \u4E2D\u57F7\u884C,\n\u518D\u628A\u6700\u7D42\u9700\u8981\u90E8\u7F72\u7684\u6A94\u6848\u5206\u5225\u8907\u88FD\u5230\u4E00\u500B docker."}),"\n",(0,o.jsx)(n.p,{children:"\u5E38\u898B\u662F\u900F\u904E\u6709\u5B8C\u6574\u958B\u767C\u74B0\u5883\u7684 container \u4F86\u7DE8\u8B6F\u7A0B\u5F0F,\n\u518D\u628A\u7DE8\u8B6F\u5F8C\u7684\u7A0B\u5F0F\u653E\u5230\u6700\u57FA\u672C\u7684\u57F7\u884C\u74B0\u5883\u4E2D\u767C\u4F48."}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-dockerfile",children:'FROM eclipse-temurin:17-jdk-alpine as build\nWORKDIR /workspace/app\n\nCOPY mvnw .\nCOPY .mvn .mvn\nCOPY pom.xml .\nCOPY src src\n\nRUN ./mvnw install -DskipTests\nRUN mkdir -p target/dependency && (cd target/dependency; jar -xf ../*.jar)\n\nFROM eclipse-temurin:17-jdk-alpine\nVOLUME /tmp\nARG DEPENDENCY=/workspace/app/target/dependency\nCOPY --from=build ${DEPENDENCY}/BOOT-INF/lib /app/lib\nCOPY --from=build ${DEPENDENCY}/META-INF /app/META-INF\nCOPY --from=build ${DEPENDENCY}/BOOT-INF/classes /app\nENTRYPOINT ["java","-cp","app:app/lib/*","hello.Application"]\n'})}),"\n",(0,o.jsx)(n.p,{children:"\u4EE5\u9019\u500B\u4F8B\u5B50\u4F86\u8AAA, \u5148\u5EFA\u7ACB\u4E86 builder \u9019\u500B container,\n\u628A\u5C08\u6848\u8A2D\u5B9A\u548C\u539F\u59CB\u7A0B\u5F0F\u6A94\u90FD\u8907\u88FD\u9032 builder \u4E2D\u9032\u884C\u5C08\u6848\u521D\u59CB\u5316\u548C\u7DE8\u8B6F."}),"\n",(0,o.jsx)(n.p,{children:"\u518D\u5EFA\u7ACB\u4E00\u500B\u57FA\u672C\u7684\u57F7\u884C\u74B0\u5883 container,\n\u628A builder \u4E2D\u6240\u7DE8\u8B6F\u7684 JAR \u548C\u76F8\u95DC\u74B0\u5883\u6A94\u6848\u8907\u88FD\u904E\u4F86."}),"\n",(0,o.jsx)(n.p,{children:"\u5982\u6B64\u4E00\u4F86, \u7528\u4F86\u90E8\u7F72\u7684 container \u88E1\u9762\u53EA\u6703\u6709 JAR binary, \u53EF\u907F\u514D\u8CC7\u5B89\u554F\u984C.\n\u5728 CI/CD \u6D41\u7A0B\u6642, \u7DE8\u8B6F JAR \u662F\u5728 docker \u4E2D\u88AB\u57F7\u884C, \u4EA6\u53EF\u907F\u514D\u74B0\u5883\u8A2D\u5B9A\u554F\u984C\u9020\u6210\u7684\u932F\u8AA4."}),"\n",(0,o.jsx)(n.p,{children:"\u53EF\u8AAA\u662F\u96C6\u524D\u5169\u500B\u65B9\u5F0F\u7684\u512A\u9EDE\u65BC\u4E00\u8EAB\u7684\u65B9\u5F0F."}),"\n",(0,o.jsxs)(n.p,{children:["Ref: ",(0,o.jsx)(n.a,{href:"https://dzone.com/articles/build-package-and-run-spring-boot-apps-with-docker",children:"Build, Package, and Run Spring Boot Apps With Docker - DZone"})]}),"\n",(0,o.jsx)(n.h2,{id:"see-also",children:"See Also"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:(0,o.jsx)(n.a,{href:"https://www.docker.com/blog/9-tips-for-containerizing-your-spring-boot-code/",children:"9 Tips for Containerizing Your Spring Boot Code | Docker"})}),"\n",(0,o.jsx)(n.li,{children:(0,o.jsx)(n.a,{href:"https://spring.io/guides/topicals/spring-boot-docker/",children:"Getting Started | Spring Boot Docker"})}),"\n",(0,o.jsx)(n.li,{children:(0,o.jsx)(n.a,{href:"https://docs.docker.com/build/building/multi-stage/",children:"Multi-stage builds"})}),"\n"]})]})}function d(e={}){let{wrapper:n}={...(0,t.a)(),...e.components};return n?(0,o.jsx)(n,{...e,children:(0,o.jsx)(p,{...e})}):p(e)}},50065:function(e,n,i){i.d(n,{Z:function(){return c},a:function(){return a}});var r=i(67294);let o={},t=r.createContext(o);function a(e){let n=r.useContext(t);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:a(e.components),r.createElement(t.Provider,{value:n},e.children)}}}]);