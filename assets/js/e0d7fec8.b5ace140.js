"use strict";(self.webpackChunkkywk_me=self.webpackChunkkywk_me||[]).push([["46482"],{72732:function(n,e,i){i.r(e),i.d(e,{frontMatter:()=>o,toc:()=>l,default:()=>g,metadata:()=>s,assets:()=>a,contentTitle:()=>t});var s=JSON.parse('{"id":"DevSecOps/Infrastructure/Nginx Docker Tips","title":"NGINX: container tips","description":"NGINX: container tips","source":"@site/moco/DevSecOps/Infrastructure/Nginx Docker Tips.md","sourceDirName":"DevSecOps/Infrastructure","slug":"/devsecops/infrastructure/nginx-docker-tips/","permalink":"/moco/devsecops/infrastructure/nginx-docker-tips/","draft":false,"unlisted":false,"tags":[{"inline":true,"label":"Infrastructure","permalink":"/moco/tags/infrastructure"},{"inline":true,"label":"NGINX","permalink":"/moco/tags/nginx"},{"inline":true,"label":"Docker","permalink":"/moco/tags/docker"}],"version":"current","frontMatter":{"title":"NGINX: container tips","description":"NGINX: container tips","tags":["Infrastructure","NGINX","Docker"],"hide_table_of_contents":true,"date_created":"2023-01-04T00:00:00.000Z","date_updated":"2023-01-04T00:00:00.000Z","image":"https://lh3.googleusercontent.com/pw/AL9nZEUA9Ifvd5Z8SXDWkeVB6AC4MPGwnXaL6kBXNPoXwOQQ2jOcZ1Jw_0p8TKK8C3ZX0e67_FOY15eDrm7aaXSQJcKtoUzC80SAQEHsaBy6qS2AqNNs5VUFNXBKm439y_1wkvmDl-PnL8ReojnIumNlEvOXBg=w800-no?authuser=0","slug":"/devsecops/infrastructure/nginx-docker-tips/"},"sidebar":"tutorialSidebar","previous":{"title":"SRE","permalink":"/moco/category/sre"},"next":{"title":"NGINX: Let\'s Encrypt SSL","permalink":"/moco/devsecops/infrastructure/nginx-lets-encrypt-ssl/"}}'),r=i(74848),c=i(84429);let o={title:"NGINX: container tips",description:"NGINX: container tips",tags:["Infrastructure","NGINX","Docker"],hide_table_of_contents:!0,date_created:new Date("2023-01-04T00:00:00.000Z"),date_updated:new Date("2023-01-04T00:00:00.000Z"),image:"https://lh3.googleusercontent.com/pw/AL9nZEUA9Ifvd5Z8SXDWkeVB6AC4MPGwnXaL6kBXNPoXwOQQ2jOcZ1Jw_0p8TKK8C3ZX0e67_FOY15eDrm7aaXSQJcKtoUzC80SAQEHsaBy6qS2AqNNs5VUFNXBKm439y_1wkvmDl-PnL8ReojnIumNlEvOXBg=w800-no?authuser=0",slug:"/devsecops/infrastructure/nginx-docker-tips/"},t="[Nginx] Container Tips",a={},l=[{value:"Basic Usage",id:"basic-usage",level:2},{value:"Quick Start",id:"quick-start",level:3},{value:"Common Port Mappings",id:"common-port-mappings",level:3},{value:"Config file",id:"config-file",level:2},{value:"Mount Configuration Files",id:"mount-configuration-files",level:3},{value:"SSL/TLS Certificates",id:"ssltls-certificates",level:3},{value:"Reload Nginx Inside Docker Container",id:"reload-nginx-inside-docker-container",level:3},{value:"Docker Compose",id:"docker-compose",level:2},{value:"Basic Setup",id:"basic-setup",level:3},{value:"With Custom Dockerfile",id:"with-custom-dockerfile",level:3},{value:"Troubleshooting",id:"troubleshooting",level:2},{value:"Check Nginx Status",id:"check-nginx-status",level:3},{value:"View Logs",id:"view-logs",level:3},{value:"Common Issues",id:"common-issues",level:3},{value:"Best Practices",id:"best-practices",level:2},{value:"Security",id:"security",level:3},{value:"Performance",id:"performance",level:3},{value:"See Also",id:"see-also",level:2}];function d(n){let e={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",ul:"ul",...(0,c.R)(),...n.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(e.header,{children:(0,r.jsx)(e.h1,{id:"nginx-container-tips",children:"[Nginx] Container Tips"})}),"\n",(0,r.jsx)(e.h2,{id:"basic-usage",children:"Basic Usage"}),"\n",(0,r.jsx)(e.h3,{id:"quick-start",children:"Quick Start"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-bash",children:"# Run nginx with default config\ndocker run -d -p 80:80 --name nginx-server nginx\n\n# Run with custom HTML\ndocker run -d -p 80:80 -v /host/html:/usr/share/nginx/html nginx\n\n# Run with custom config\ndocker run -d -p 80:80 -v /host/nginx.conf:/etc/nginx/nginx.conf nginx\n"})}),"\n",(0,r.jsx)(e.h3,{id:"common-port-mappings",children:"Common Port Mappings"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-bash",children:"# HTTP only\ndocker run -d -p 80:80 nginx\n\n# HTTPS only\ndocker run -d -p 443:443 nginx\n\n# Both HTTP and HTTPS\ndocker run -d -p 80:80 -p 443:443 nginx\n\n# Custom ports\ndocker run -d -p 8080:80 -p 8443:443 nginx\n"})}),"\n",(0,r.jsx)(e.h2,{id:"config-file",children:"Config file"}),"\n",(0,r.jsx)(e.h3,{id:"mount-configuration-files",children:"Mount Configuration Files"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-bash",children:"# Mount main config\ndocker run -d -p 80:80 \\\n  -v /host/nginx.conf:/etc/nginx/nginx.conf \\\n  nginx\n\n# Mount config directory\ndocker run -d -p 80:80 \\\n  -v /host/nginx:/etc/nginx \\\n  nginx\n\n# Mount sites config\ndocker run -d -p 80:80 \\\n  -v /host/sites:/etc/nginx/conf.d \\\n  nginx\n"})}),"\n",(0,r.jsx)(e.h3,{id:"ssltls-certificates",children:"SSL/TLS Certificates"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-bash",children:"# Mount SSL certificates\ndocker run -d -p 443:443 \\\n  -v /host/ssl:/etc/nginx/ssl \\\n  -v /host/nginx.conf:/etc/nginx/nginx.conf \\\n  nginx\n"})}),"\n",(0,r.jsx)(e.h3,{id:"reload-nginx-inside-docker-container",children:"Reload Nginx Inside Docker Container"}),"\n",(0,r.jsxs)(e.ol,{children:["\n",(0,r.jsxs)(e.li,{children:["\n",(0,r.jsx)(e.p,{children:"Find your container name\nUse docker ps to find your nginx container."}),"\n"]}),"\n",(0,r.jsxs)(e.li,{children:["\n",(0,r.jsxs)(e.p,{children:["Reload Nginx\nWith ",(0,r.jsx)(e.code,{children:"docker exec -it {container_name} {command}"})," you can directly access your container and execute commands. In my case the name of the container is nginx-server."]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-bash",children:"$ docker exec -it nginx-server nginx -s reload\n2016/08/18 09:52:38 [notice] 19#19: signal process started\n$ docker exec -it nginx-server nginx -s reload\n2016/08/18 09:52:38 [notice] 19#19: signal process started\n"})}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(e.h2,{id:"docker-compose",children:"Docker Compose"}),"\n",(0,r.jsx)(e.h3,{id:"basic-setup",children:"Basic Setup"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-yaml",children:'version: "3.8"\nservices:\n  nginx:\n    image: nginx:alpine\n    ports:\n      - "80:80"\n      - "443:443"\n    volumes:\n      - ./html:/usr/share/nginx/html\n      - ./nginx.conf:/etc/nginx/nginx.conf\n      - ./ssl:/etc/nginx/ssl\n    restart: unless-stopped\n'})}),"\n",(0,r.jsx)(e.h3,{id:"with-custom-dockerfile",children:"With Custom Dockerfile"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-yaml",children:'version: "3.8"\nservices:\n  nginx:\n    build: .\n    ports:\n      - "80:80"\n    volumes:\n      - ./html:/usr/share/nginx/html\n'})}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-dockerfile",children:"FROM nginx:alpine\nCOPY nginx.conf /etc/nginx/nginx.conf\nCOPY sites/ /etc/nginx/conf.d/\nEXPOSE 80 443\n"})}),"\n",(0,r.jsx)(e.h2,{id:"troubleshooting",children:"Troubleshooting"}),"\n",(0,r.jsx)(e.h3,{id:"check-nginx-status",children:"Check Nginx Status"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-bash",children:"# Check if nginx is running\ndocker exec nginx-server nginx -t\n\n# View nginx processes\ndocker exec nginx-server ps aux | grep nginx\n\n# Check nginx version\ndocker exec nginx-server nginx -v\n"})}),"\n",(0,r.jsx)(e.h3,{id:"view-logs",children:"View Logs"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-bash",children:"# View access logs\ndocker exec nginx-server tail -f /var/log/nginx/access.log\n\n# View error logs\ndocker exec nginx-server tail -f /var/log/nginx/error.log\n\n# View all logs\ndocker logs nginx-server\n"})}),"\n",(0,r.jsx)(e.h3,{id:"common-issues",children:"Common Issues"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-bash",children:"# Permission issues - fix ownership\ndocker exec nginx-server chown -R nginx:nginx /usr/share/nginx/html\n\n# Config syntax check\ndocker exec nginx-server nginx -t\n\n# Restart nginx process\ndocker exec nginx-server nginx -s reload\n"})}),"\n",(0,r.jsx)(e.h2,{id:"best-practices",children:"Best Practices"}),"\n",(0,r.jsx)(e.h3,{id:"security",children:"Security"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-bash",children:"# Run as non-root user\ndocker run -d --user nginx nginx\n\n# Limit resources\ndocker run -d --memory=512m --cpus=0.5 nginx\n\n# Read-only root filesystem\ndocker run -d --read-only --tmpfs /var/cache/nginx nginx\n"})}),"\n",(0,r.jsx)(e.h3,{id:"performance",children:"Performance"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-bash",children:"# Use alpine for smaller image\ndocker run -d nginx:alpine\n\n# Mount cache as tmpfs\ndocker run -d --tmpfs /var/cache/nginx nginx\n"})}),"\n",(0,r.jsx)(e.h2,{id:"see-also",children:"See Also"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:(0,r.jsx)(e.a,{href:"https://hub.docker.com/_/nginx",children:"nginx - Official Image | Docker Hub"})}),"\n",(0,r.jsx)(e.li,{children:(0,r.jsx)(e.a,{href:"http://blog.tobiasforkel.de/en/2016/08/18/reload-nginx-inside-docker-container/",children:"Reload Nginx Inside Docker Container \u2013 Tobias Forkel \u2013 Blog \u2013 PHP / Magento Developer located in Melbourne, Australia"})}),"\n",(0,r.jsx)(e.li,{children:(0,r.jsx)(e.a,{href:"https://www.digitalocean.com/community/tutorials/how-to-run-nginx-in-a-docker-container-on-ubuntu-14-04",children:"Docker Nginx Tutorial | DigitalOcean"})}),"\n",(0,r.jsx)(e.li,{children:(0,r.jsx)(e.a,{href:"https://docs.nginx.com/nginx/admin-guide/installing-nginx/installing-nginx-docker/",children:"Nginx Docker Best Practices"})}),"\n"]})]})}function g(n={}){let{wrapper:e}={...(0,c.R)(),...n.components};return e?(0,r.jsx)(e,{...n,children:(0,r.jsx)(d,{...n})}):d(n)}},84429:function(n,e,i){i.d(e,{R:()=>o,x:()=>t});var s=i(96540);let r={},c=s.createContext(r);function o(n){let e=s.useContext(c);return s.useMemo(function(){return"function"==typeof n?n(e):{...e,...n}},[e,n])}function t(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(r):n.components||r:o(n.components),s.createElement(c.Provider,{value:e},n.children)}}}]);