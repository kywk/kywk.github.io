"use strict";(self.webpackChunkkywk_me=self.webpackChunkkywk_me||[]).push([["66282"],{48866:function(e,c,n){n.r(c),n.d(c,{metadata:()=>r,contentTitle:()=>i,default:()=>a,assets:()=>s,toc:()=>h,frontMatter:()=>l});var r=JSON.parse('{"id":"devsecops/docker/dockerfile/dockerfile_healthy-check","title":"HEALTHCHECK \u5065\u5EB7\u6AA2\u67E5","description":"Docker health check","source":"@site/moco/devsecops/docker/dockerfile/dockerfile_healthy-check.md","sourceDirName":"devsecops/docker/dockerfile","slug":"/devsecops/docker/dockerfile/dockerfile_healthy-check","permalink":"/moco/devsecops/docker/dockerfile/dockerfile_healthy-check","draft":false,"unlisted":false,"tags":[{"inline":true,"label":"Docker/Dockerfile","permalink":"/moco/tags/docker-dockerfile"}],"version":"current","frontMatter":{"title":"HEALTHCHECK \u5065\u5EB7\u6AA2\u67E5","description":"Docker health check","tags":["Docker/Dockerfile"],"hide_table_of_contents":true,"date_created":"2023-03-15T00:00:00.000Z","date_update":"2023-03-15T00:00:00.000Z","cover":"https://lh3.googleusercontent.com/pw/AL9nZEUA9Ifvd5Z8SXDWkeVB6AC4MPGwnXaL6kBXNPoXwOQQ2jOcZ1Jw_0p8TKK8C3ZX0e67_FOY15eDrm7aaXSQJcKtoUzC80SAQEHsaBy6qS2AqNNs5VUFNXBKm439y_1wkvmDl-PnL8ReojnIumNlEvOXBg=w800-no?authuser=0"},"sidebar":"tutorialSidebar","previous":{"title":"Dockerfile","permalink":"/moco/category/dockerfile"},"next":{"title":"CLI Snippets","permalink":"/moco/devsecops/docker/Docker CLI Snippets"}}'),t=n("85893"),o=n("50065");let l={title:"HEALTHCHECK \u5065\u5EB7\u6AA2\u67E5",description:"Docker health check",tags:["Docker/Dockerfile"],hide_table_of_contents:!0,date_created:new Date("2023-03-15T00:00:00.000Z"),date_update:new Date("2023-03-15T00:00:00.000Z"),cover:"https://lh3.googleusercontent.com/pw/AL9nZEUA9Ifvd5Z8SXDWkeVB6AC4MPGwnXaL6kBXNPoXwOQQ2jOcZ1Jw_0p8TKK8C3ZX0e67_FOY15eDrm7aaXSQJcKtoUzC80SAQEHsaBy6qS2AqNNs5VUFNXBKm439y_1wkvmDl-PnL8ReojnIumNlEvOXBg=w800-no?authuser=0"},i="[Dockerfile] HEALTHCHECK \u5065\u5EB7\u6AA2\u67E5",s={},h=[{value:"\u524D\u8A00",id:"\u524D\u8A00",level:2},{value:"Health Check",id:"health-check",level:2},{value:"format",id:"format",level:3},{value:"options",id:"options",level:3},{value:"See Also",id:"see-also",level:2}];function d(e){let c={a:"a",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",ul:"ul",...(0,o.a)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(c.header,{children:(0,t.jsx)(c.h1,{id:"dockerfile-healthcheck-\u5065\u5EB7\u6AA2\u67E5",children:"[Dockerfile] HEALTHCHECK \u5065\u5EB7\u6AA2\u67E5"})}),"\n",(0,t.jsx)(c.h2,{id:"\u524D\u8A00",children:"\u524D\u8A00"}),"\n",(0,t.jsx)(c.p,{children:"\u5728\u6C92\u6709 HEALTHCHECK \u6307\u4EE4\u4E4B\u524D, Docker \u53EA\u80FD\u900F\u904E process \u662F\u5426\u9000\u51FA\u4F86\u5224\u65B7 container \u7684\u72C0\u614B.\n\u4E0D\u904E\u6709\u6642\u5019\u662F\u670D\u52D9\u5DF2\u7D93\u7121\u6CD5\u6B63\u5E38\u904B\u4F5C\u4E86, \u4F46 process \u6C92\u6709\u9000\u51FA, \u9019\u6A23\u6703\u5C0E\u81F4\u8A72\u670D\u52D9\u4ECD\u7136\u53EF\u4EE5\u63A5\u6536\u7528\u6236\u8ACB\u6C42, \u4F46\u662F\u7121\u6CD5\u6B63\u5E38\u56DE\u61C9."}),"\n",(0,t.jsx)(c.h2,{id:"health-check",children:"Health Check"}),"\n",(0,t.jsxs)(c.p,{children:["\u5728 Docker \u7248\u672C ",(0,t.jsx)(c.code,{children:"1.12"})," \u4E4B\u5F8C\u63D0\u4F9B\u4E86 ",(0,t.jsx)(c.code,{children:"HEALTHCHECK"})," \u6307\u4EE4,\n\u53EF\u4EE5\u8A2D\u5B9A\u4E00\u884C command \u7528\u4F86\u5224\u65B7\u670D\u52D9\u7684\u72C0\u614B\u662F\u5426\u6B63\u5E38, \u9019\u6A23\u53EF\u4EE5\u66F4\u6E96\u78BA\u5730\u5224\u65B7\u670D\u52D9\u72C0\u614B."]}),"\n",(0,t.jsxs)(c.p,{children:["Container \u555F\u52D5\u5F8C\u7684\u521D\u59CB\u72C0\u614B\u70BA ",(0,t.jsx)(c.code,{children:"starting"}),", \u5728 HEALTHCHECK \u6307\u4EE4\u6AA2\u67E5\u6210\u529F\u5F8C, \u72C0\u614B\u6703\u66F4\u6539\u70BA ",(0,t.jsx)(c.code,{children:"healthy"}),".\n\u5982\u679C\u9023\u7E8C\u5931\u6557\u8D85\u904E\u6307\u5B9A\u6B21\u6578\u5247\u6703\u6539\u70BA ",(0,t.jsx)(c.code,{children:"unhealthy"}),"."]}),"\n",(0,t.jsx)(c.h3,{id:"format",children:"format"}),"\n",(0,t.jsxs)(c.ul,{children:["\n",(0,t.jsx)(c.li,{children:"HEALTHCHECK [OPTIONS] CMD command (check container health by running a command inside the container)"}),"\n",(0,t.jsx)(c.li,{children:"HEALTHCHECK NONE (disable any healthcheck inherited from the base image)"}),"\n"]}),"\n",(0,t.jsx)(c.h3,{id:"options",children:"options"}),"\n",(0,t.jsxs)(c.ul,{children:["\n",(0,t.jsxs)(c.li,{children:[(0,t.jsx)(c.code,{children:"--interval=DURATION"})," (",(0,t.jsx)(c.em,{children:"default: 30s"}),")"]}),"\n",(0,t.jsxs)(c.li,{children:[(0,t.jsx)(c.code,{children:"--timeout=DURATION"})," (",(0,t.jsx)(c.em,{children:"default: 30s"}),")"]}),"\n",(0,t.jsxs)(c.li,{children:[(0,t.jsx)(c.code,{children:"--start-period=DURATION"})," (",(0,t.jsx)(c.em,{children:"default: 0s"}),")"]}),"\n",(0,t.jsxs)(c.li,{children:[(0,t.jsx)(c.code,{children:"--retries=N"})," (",(0,t.jsx)(c.em,{children:"default: 3"}),")"]}),"\n"]}),"\n",(0,t.jsx)(c.h2,{id:"see-also",children:"See Also"}),"\n",(0,t.jsxs)(c.ul,{children:["\n",(0,t.jsx)(c.li,{children:(0,t.jsx)(c.a,{href:"https://docs.docker.com/engine/reference/builder/#healthcheck",children:"Dockerfile reference"})}),"\n",(0,t.jsx)(c.li,{children:(0,t.jsx)(c.a,{href:"https://dockerlabs.collabnix.com/beginners/dockerfile/healthcheck.html",children:"Lab #14: Create a Docker Image with HEALTHCHECK instruction | dockerlabs"})}),"\n",(0,t.jsx)(c.li,{children:(0,t.jsx)(c.a,{href:"https://yeasy.gitbook.io/docker_practice/image/dockerfile/healthcheck",children:"HEALTHCHECK \u5065\u5EB7\u68C0\u67E5 - Docker \u2014 \u4ECE\u5165\u95E8\u5230\u5B9E\u8DF5"})}),"\n",(0,t.jsx)(c.li,{children:(0,t.jsx)(c.a,{href:"https://wshs0713.github.io/posts/b8226bad/",children:"[Docker] Health Check and Restart Unhealthy Container | wshs0713's blog"})}),"\n"]})]})}function a(e={}){let{wrapper:c}={...(0,o.a)(),...e.components};return c?(0,t.jsx)(c,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}},50065:function(e,c,n){n.d(c,{Z:function(){return i},a:function(){return l}});var r=n(67294);let t={},o=r.createContext(t);function l(e){let c=r.useContext(o);return r.useMemo(function(){return"function"==typeof e?e(c):{...c,...e}},[c,e])}function i(e){let c;return c=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:l(e.components),r.createElement(o.Provider,{value:c},e.children)}}}]);