"use strict";(self.webpackChunkblog_kywk=self.webpackChunkblog_kywk||[]).push([[69169],{92162:(n,e,i)=>{i.r(e),i.d(e,{assets:()=>s,contentTitle:()=>a,default:()=>d,frontMatter:()=>t,metadata:()=>c,toc:()=>l});var o=i(85893),r=i(11151);const t={title:"Dockerize",description:"Dockerize Spring Boot application",tags:["SpringBoot","Docker"],sidebar_position:80,hide_table_of_contents:!0,created:new Date("2023-03-14T00:00:00.000Z"),updated:new Date("2023-03-14T00:00:00.000Z"),image:"https://lh3.googleusercontent.com/pw/AL9nZEUA9Ifvd5Z8SXDWkeVB6AC4MPGwnXaL6kBXNPoXwOQQ2jOcZ1Jw_0p8TKK8C3ZX0e67_FOY15eDrm7aaXSQJcKtoUzC80SAQEHsaBy6qS2AqNNs5VUFNXBKm439y_1wkvmDl-PnL8ReojnIumNlEvOXBg=w800-no?authuser=0"},a="[SpringBoot] Dockerize Spring Boot Application",c={id:"java/springboot/misc_dockerize",title:"Dockerize",description:"Dockerize Spring Boot application",source:"@site/moco/java/springboot/misc_dockerize.md",sourceDirName:"java/springboot",slug:"/java/springboot/misc_dockerize",permalink:"/moco/java/springboot/misc_dockerize",draft:!1,unlisted:!1,tags:[{label:"SpringBoot",permalink:"/moco/tags/spring-boot"},{label:"Docker",permalink:"/moco/tags/docker"}],version:"current",sidebarPosition:80,frontMatter:{title:"Dockerize",description:"Dockerize Spring Boot application",tags:["SpringBoot","Docker"],sidebar_position:80,hide_table_of_contents:!0,created:"2023-03-14T00:00:00.000Z",updated:"2023-03-14T00:00:00.000Z",image:"https://lh3.googleusercontent.com/pw/AL9nZEUA9Ifvd5Z8SXDWkeVB6AC4MPGwnXaL6kBXNPoXwOQQ2jOcZ1Jw_0p8TKK8C3ZX0e67_FOY15eDrm7aaXSQJcKtoUzC80SAQEHsaBy6qS2AqNNs5VUFNXBKm439y_1wkvmDl-PnL8ReojnIumNlEvOXBg=w800-no?authuser=0"},sidebar:"tutorialSidebar",previous:{title:"Docker versioning",permalink:"/moco/java/springboot/misc_docker-versioning"},next:{title:"SpEL expressions",permalink:"/moco/java/springboot/spring/spring_spel-expressions"}},s={},l=[{value:"Run w/ Java source",id:"run-w-java-source",level:2},{value:"Run w/ JAR binary",id:"run-w-jar-binary",level:2},{value:"Multi-Stage Build",id:"multi-stage-build",level:2},{value:"See Also",id:"see-also",level:2}];function p(n){const e={a:"a",blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.a)(),...n.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(e.h1,{id:"springboot-dockerize-spring-boot-application",children:"[SpringBoot] Dockerize Spring Boot Application"}),"\n",(0,o.jsx)(e.p,{children:"\u5efa\u7acb Sprint Boot Application Container \u4e0d\u5916\u4e4e\u5169\u7a2e\u65b9\u5f0f:"}),"\n",(0,o.jsxs)(e.ol,{children:["\n",(0,o.jsx)(e.li,{children:"\u628a\u539f\u59cb\u78bc\u653e\u5165 container, \u900f\u904e mvn \u5728 container \u8dd1."}),"\n",(0,o.jsx)(e.li,{children:"\u628a Sprint Boot \u7de8\u8b6f\u6210 .jar \u6a94\u5f8c\u653e\u5165 Container, \u900f\u904e Java \u4f86\u57f7\u884c."}),"\n"]}),"\n",(0,o.jsx)(e.h2,{id:"run-w-java-source",children:"Run w/ Java source"}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-dockerfile",children:'FROM eclipse-temurin\nWORKDIR /app\n \nCOPY .mvn/ .mvn\nCOPY mvnw pom.xml ./\nRUN ./mvnw dependency:go-offline\n \nCOPY src ./src\n \nCMD ["./mvnw", "spring-boot:run"]\n'})}),"\n",(0,o.jsx)(e.p,{children:"\u9019\u500b Dockerfile \u628a source code \u6253\u5305\u9032 container \u521d\u59cb\u5316\u5c08\u6848\u6a94\u6848\u5f8c,\n\u900f\u904e mvn \u4f86\u7de8\u8b6f\u8207\u555f\u52d5 sprint boot application."}),"\n",(0,o.jsx)(e.p,{children:"\u9019\u6a23\u7684 image \u9700\u8981\u628a\u5b8c\u6574\u7de8\u8b6f\u74b0\u5883\u548c\u7a0b\u5f0f\u90fd\u653e\u5165 container \u4e2d,\n\u512a\u9ede\u662f\u82e5 CI/CD \u74b0\u5883\u4e2d\u6c92\u6709 JDK \u74b0\u5883, \u4ecd\u53ef\u7de8\u8b6f\u51fa\u53ef\u4ee5\u6b63\u5e38\u57f7\u884c\u7684 Spring Boot container."}),"\n",(0,o.jsx)(e.p,{children:"\u4f46\u4e00\u822c\u4f86\u8aaa, \u9664\u975e\u90e8\u5c6c\u57f7\u884c container \u74b0\u5883\u90fd\u662f\u81ea\u5bb6\u63a7\u7ba1\u7684, \u5426\u5247\u4e0d\u6703\u63a1\u7528\u9019\u7a2e\u65b9\u5f0f.\n\u7562\u7adf container \u4e2d\u6a94\u6848\u662f\u7121\u6cd5\u88ab\u4fdd\u8b77, \u539f\u59cb\u78bc\u653e\u5165 container \u90e8\u5c6c\u51fa\u53bb, \u7b49\u65bc\u7a0b\u5f0f\u88f8\u5954\u5728\u5916.\n\u82e5\u7a0b\u5f0f\u6709\u91cd\u8981\u5546\u52d9\u908f\u8f2f\u6216\u52a0\u89e3\u5bc6\u8cc7\u8a0a, \u662f\u76f8\u7576\u5371\u96aa\u7684."}),"\n",(0,o.jsxs)(e.p,{children:["Ref: ",(0,o.jsx)(e.a,{href:"https://dhruv-saksena.medium.com/build-deploy-a-spring-boot-application-in-docker-container-49b9b2d3e25e",children:"Build & Deploy a Spring Boot application in Docker container | by Dhruv Saksena | Medium"})]}),"\n",(0,o.jsx)(e.h2,{id:"run-w-jar-binary",children:"Run w/ JAR binary"}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-dockerfile",children:'FROM openjdk:11-jdk-alpine\nVOLUME /tmp\nARG JAR_FILE\nCOPY ${JAR_FILE} app.jar\nENTRYPOINT ["java","-jar","/app.jar"]\n'})}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-shell",children:"mvn install dockerfile:build\n"})}),"\n",(0,o.jsx)(e.p,{children:"\u76f8\u5c0d\u65bc\u524d\u8005, \u9019\u500b\u65b9\u5f0f\u662f\u5148\u628a Java \u7de8\u8b6f\u6210 JAR \u6a94,\n\u9700\u6e96\u5099\u57fa\u672c\u7684 Java runtime container,\n\u628a JAR \u653e\u5165 container \u4e2d\u5373\u53ef\u57f7\u884c."}),"\n",(0,o.jsx)(e.p,{children:"\u82e5\u8981\u90e8\u5c6c\u5230\u5916\u90e8\u74b0\u5883, \u7de8\u8b6f\u5f8c\u7684 binary \u8f03\u4e0d\u5bb9\u6613\u88ab\u7834\u89e3."}),"\n",(0,o.jsx)(e.p,{children:"\u4f46\u82e5\u8981\u5728 CI/CD \u4e2d\u6253\u5305 container, \u5247\u9700\u78ba\u5b9a CI/CD runner \u4e0a\u662f\u6b63\u78ba\u5c0d\u61c9 JDK \u7248\u672c.\n\u53ef\u80fd\u4e0d\u540c\u5c08\u6848\u4f7f\u7528\u4e86\u4e0d\u540c JDK \u6216 mvn \u7248\u672c, \u9020\u6210 CI/CD \u8a2d\u5b9a\u4e0a\u7684\u8907\u96dc\u6216\u51fa\u932f."}),"\n",(0,o.jsx)(e.p,{children:"\u4e0d\u8003\u616e CI/CD \u60c5\u6cc1, \u7531 develop \u624b\u52d5 build docker image \u7684\u8a71, \u9019\u662f\u9069\u5408\u7684\u65b9\u5f0f."}),"\n",(0,o.jsx)(e.h2,{id:"multi-stage-build",children:"Multi-Stage Build"}),"\n",(0,o.jsxs)(e.blockquote,{children:["\n",(0,o.jsxs)(e.p,{children:[(0,o.jsx)(e.a,{href:"https://docs.docker.com/build/building/multi-stage/",children:"Multi-stage builds"})," are useful to anyone who has struggled to optimize\n",(0,o.jsx)(e.strong,{children:"Dockerfiles"})," while keeping them easy to read and maintain."]}),"\n"]}),"\n",(0,o.jsx)(e.p,{children:"Docker \u652f\u63f4 Multi-Stage Build, \u53ef\u4ee5\u628a\u4e0d\u540c\u968e\u6bb5\u7684\u9700\u6c42\u62c6\u958b\u5230\u5728\u4e0d\u540c docker \u4e2d\u57f7\u884c,\n\u518d\u628a\u6700\u7d42\u9700\u8981\u90e8\u7f72\u7684\u6a94\u6848\u5206\u5225\u8907\u88fd\u5230\u4e00\u500b docker."}),"\n",(0,o.jsx)(e.p,{children:"\u5e38\u898b\u662f\u900f\u904e\u6709\u5b8c\u6574\u958b\u767c\u74b0\u5883\u7684 container \u4f86\u7de8\u8b6f\u7a0b\u5f0f,\n\u518d\u628a\u7de8\u8b6f\u5f8c\u7684\u7a0b\u5f0f\u653e\u5230\u6700\u57fa\u672c\u7684\u57f7\u884c\u74b0\u5883\u4e2d\u767c\u4f48."}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-dockerfile",children:'FROM eclipse-temurin:17-jdk-alpine as build\nWORKDIR /workspace/app\n\nCOPY mvnw .\nCOPY .mvn .mvn\nCOPY pom.xml .\nCOPY src src\n\nRUN ./mvnw install -DskipTests\nRUN mkdir -p target/dependency && (cd target/dependency; jar -xf ../*.jar)\n\nFROM eclipse-temurin:17-jdk-alpine\nVOLUME /tmp\nARG DEPENDENCY=/workspace/app/target/dependency\nCOPY --from=build ${DEPENDENCY}/BOOT-INF/lib /app/lib\nCOPY --from=build ${DEPENDENCY}/META-INF /app/META-INF\nCOPY --from=build ${DEPENDENCY}/BOOT-INF/classes /app\nENTRYPOINT ["java","-cp","app:app/lib/*","hello.Application"]\n'})}),"\n",(0,o.jsx)(e.p,{children:"\u4ee5\u9019\u500b\u4f8b\u5b50\u4f86\u8aaa, \u5148\u5efa\u7acb\u4e86 builder \u9019\u500b container,\n\u628a\u5c08\u6848\u8a2d\u5b9a\u548c\u539f\u59cb\u7a0b\u5f0f\u6a94\u90fd\u8907\u88fd\u9032 builder \u4e2d\u9032\u884c\u5c08\u6848\u521d\u59cb\u5316\u548c\u7de8\u8b6f."}),"\n",(0,o.jsx)(e.p,{children:"\u518d\u5efa\u7acb\u4e00\u500b\u57fa\u672c\u7684\u57f7\u884c\u74b0\u5883 container,\n\u628a builder \u4e2d\u6240\u7de8\u8b6f\u7684 JAR \u548c\u76f8\u95dc\u74b0\u5883\u6a94\u6848\u8907\u88fd\u904e\u4f86."}),"\n",(0,o.jsx)(e.p,{children:"\u5982\u6b64\u4e00\u4f86, \u7528\u4f86\u90e8\u7f72\u7684 container \u88e1\u9762\u53ea\u6703\u6709 JAR binary, \u53ef\u907f\u514d\u8cc7\u5b89\u554f\u984c.\n\u5728 CI/CD \u6d41\u7a0b\u6642, \u7de8\u8b6f JAR \u662f\u5728 docker \u4e2d\u88ab\u57f7\u884c, \u4ea6\u53ef\u907f\u514d\u74b0\u5883\u8a2d\u5b9a\u554f\u984c\u9020\u6210\u7684\u932f\u8aa4."}),"\n",(0,o.jsx)(e.p,{children:"\u53ef\u8aaa\u662f\u96c6\u524d\u5169\u500b\u65b9\u5f0f\u7684\u512a\u9ede\u65bc\u4e00\u8eab\u7684\u65b9\u5f0f."}),"\n",(0,o.jsxs)(e.p,{children:["Ref: ",(0,o.jsx)(e.a,{href:"https://dzone.com/articles/build-package-and-run-spring-boot-apps-with-docker",children:"Build, Package, and Run Spring Boot Apps With Docker - DZone"})]}),"\n",(0,o.jsx)(e.h2,{id:"see-also",children:"See Also"}),"\n",(0,o.jsxs)(e.ul,{children:["\n",(0,o.jsx)(e.li,{children:(0,o.jsx)(e.a,{href:"https://www.docker.com/blog/9-tips-for-containerizing-your-spring-boot-code/",children:"9 Tips for Containerizing Your Spring Boot Code | Docker"})}),"\n",(0,o.jsx)(e.li,{children:(0,o.jsx)(e.a,{href:"https://spring.io/guides/topicals/spring-boot-docker/",children:"Getting Started | Spring Boot Docker"})}),"\n",(0,o.jsx)(e.li,{children:(0,o.jsx)(e.a,{href:"https://docs.docker.com/build/building/multi-stage/",children:"Multi-stage builds"})}),"\n"]})]})}function d(n={}){const{wrapper:e}={...(0,r.a)(),...n.components};return e?(0,o.jsx)(e,{...n,children:(0,o.jsx)(p,{...n})}):p(n)}},11151:(n,e,i)=>{i.d(e,{Z:()=>c,a:()=>a});var o=i(67294);const r={},t=o.createContext(r);function a(n){const e=o.useContext(t);return o.useMemo((function(){return"function"==typeof n?n(e):{...e,...n}}),[e,n])}function c(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(r):n.components||r:a(n.components),o.createElement(t.Provider,{value:e},n.children)}}}]);