"use strict";(self.webpackChunkblog_kywk=self.webpackChunkblog_kywk||[]).push([[4889],{16595:(e,c,n)=>{n.r(c),n.d(c,{assets:()=>s,contentTitle:()=>l,default:()=>a,frontMatter:()=>r,metadata:()=>i,toc:()=>d});var o=n(85893),t=n(11151);const r={title:"HEALTHCHECK \u5065\u5eb7\u6aa2\u67e5",description:"Docker health check",tags:["Docker/Dockerfile"],hide_table_of_contents:!0,date_created:new Date("2023-03-15T00:00:00.000Z"),date_updated:new Date("2023-03-15T00:00:00.000Z"),image:"https://lh3.googleusercontent.com/pw/AL9nZEUA9Ifvd5Z8SXDWkeVB6AC4MPGwnXaL6kBXNPoXwOQQ2jOcZ1Jw_0p8TKK8C3ZX0e67_FOY15eDrm7aaXSQJcKtoUzC80SAQEHsaBy6qS2AqNNs5VUFNXBKm439y_1wkvmDl-PnL8ReojnIumNlEvOXBg=w800-no?authuser=0"},l="[Dockerfile] HEALTHCHECK \u5065\u5eb7\u6aa2\u67e5",i={id:"devsecops/docker/dockerfile/dockerfile_healthy-check",title:"HEALTHCHECK \u5065\u5eb7\u6aa2\u67e5",description:"Docker health check",source:"@site/moco/devsecops/docker/dockerfile/dockerfile_healthy-check.md",sourceDirName:"devsecops/docker/dockerfile",slug:"/devsecops/docker/dockerfile/dockerfile_healthy-check",permalink:"/moco/devsecops/docker/dockerfile/dockerfile_healthy-check",draft:!1,unlisted:!1,tags:[{label:"Docker/Dockerfile",permalink:"/moco/tags/docker-dockerfile"}],version:"current",frontMatter:{title:"HEALTHCHECK \u5065\u5eb7\u6aa2\u67e5",description:"Docker health check",tags:["Docker/Dockerfile"],hide_table_of_contents:!0,date_created:"2023-03-15T00:00:00.000Z",date_updated:"2023-03-15T00:00:00.000Z",image:"https://lh3.googleusercontent.com/pw/AL9nZEUA9Ifvd5Z8SXDWkeVB6AC4MPGwnXaL6kBXNPoXwOQQ2jOcZ1Jw_0p8TKK8C3ZX0e67_FOY15eDrm7aaXSQJcKtoUzC80SAQEHsaBy6qS2AqNNs5VUFNXBKm439y_1wkvmDl-PnL8ReojnIumNlEvOXBg=w800-no?authuser=0"},sidebar:"tutorialSidebar",previous:{title:"Dockerfile",permalink:"/moco/category/dockerfile"},next:{title:"Docker Compose",permalink:"/moco/category/docker-compose"}},s={},d=[{value:"\u524d\u8a00",id:"\u524d\u8a00",level:2},{value:"Health Check",id:"health-check",level:2},{value:"format",id:"format",level:3},{value:"options",id:"options",level:3},{value:"See Also",id:"see-also",level:2}];function h(e){const c={a:"a",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",li:"li",p:"p",ul:"ul",...(0,t.a)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(c.h1,{id:"dockerfile-healthcheck-\u5065\u5eb7\u6aa2\u67e5",children:"[Dockerfile] HEALTHCHECK \u5065\u5eb7\u6aa2\u67e5"}),"\n",(0,o.jsx)(c.h2,{id:"\u524d\u8a00",children:"\u524d\u8a00"}),"\n",(0,o.jsx)(c.p,{children:"\u5728\u6c92\u6709 HEALTHCHECK \u6307\u4ee4\u4e4b\u524d, Docker \u53ea\u80fd\u900f\u904e process \u662f\u5426\u9000\u51fa\u4f86\u5224\u65b7 container \u7684\u72c0\u614b.\n\u4e0d\u904e\u6709\u6642\u5019\u662f\u670d\u52d9\u5df2\u7d93\u7121\u6cd5\u6b63\u5e38\u904b\u4f5c\u4e86, \u4f46 process \u6c92\u6709\u9000\u51fa, \u9019\u6a23\u6703\u5c0e\u81f4\u8a72\u670d\u52d9\u4ecd\u7136\u53ef\u4ee5\u63a5\u6536\u7528\u6236\u8acb\u6c42, \u4f46\u662f\u7121\u6cd5\u6b63\u5e38\u56de\u61c9."}),"\n",(0,o.jsx)(c.h2,{id:"health-check",children:"Health Check"}),"\n",(0,o.jsxs)(c.p,{children:["\u5728 Docker \u7248\u672c ",(0,o.jsx)(c.code,{children:"1.12"})," \u4e4b\u5f8c\u63d0\u4f9b\u4e86 ",(0,o.jsx)(c.code,{children:"HEALTHCHECK"})," \u6307\u4ee4,\n\u53ef\u4ee5\u8a2d\u5b9a\u4e00\u884c command \u7528\u4f86\u5224\u65b7\u670d\u52d9\u7684\u72c0\u614b\u662f\u5426\u6b63\u5e38, \u9019\u6a23\u53ef\u4ee5\u66f4\u6e96\u78ba\u5730\u5224\u65b7\u670d\u52d9\u72c0\u614b."]}),"\n",(0,o.jsxs)(c.p,{children:["Container \u555f\u52d5\u5f8c\u7684\u521d\u59cb\u72c0\u614b\u70ba ",(0,o.jsx)(c.code,{children:"starting"}),", \u5728 HEALTHCHECK \u6307\u4ee4\u6aa2\u67e5\u6210\u529f\u5f8c, \u72c0\u614b\u6703\u66f4\u6539\u70ba ",(0,o.jsx)(c.code,{children:"healthy"}),".\n\u5982\u679c\u9023\u7e8c\u5931\u6557\u8d85\u904e\u6307\u5b9a\u6b21\u6578\u5247\u6703\u6539\u70ba ",(0,o.jsx)(c.code,{children:"unhealthy"}),"."]}),"\n",(0,o.jsx)(c.h3,{id:"format",children:"format"}),"\n",(0,o.jsxs)(c.ul,{children:["\n",(0,o.jsx)(c.li,{children:"HEALTHCHECK [OPTIONS] CMD command (check container health by running a command inside the container)"}),"\n",(0,o.jsx)(c.li,{children:"HEALTHCHECK NONE (disable any healthcheck inherited from the base image)"}),"\n"]}),"\n",(0,o.jsx)(c.h3,{id:"options",children:"options"}),"\n",(0,o.jsxs)(c.ul,{children:["\n",(0,o.jsxs)(c.li,{children:[(0,o.jsx)(c.code,{children:"--interval=DURATION"})," (",(0,o.jsx)(c.em,{children:"default: 30s"}),")"]}),"\n",(0,o.jsxs)(c.li,{children:[(0,o.jsx)(c.code,{children:"--timeout=DURATION"})," (",(0,o.jsx)(c.em,{children:"default: 30s"}),")"]}),"\n",(0,o.jsxs)(c.li,{children:[(0,o.jsx)(c.code,{children:"--start-period=DURATION"})," (",(0,o.jsx)(c.em,{children:"default: 0s"}),")"]}),"\n",(0,o.jsxs)(c.li,{children:[(0,o.jsx)(c.code,{children:"--retries=N"})," (",(0,o.jsx)(c.em,{children:"default: 3"}),")"]}),"\n"]}),"\n",(0,o.jsx)(c.h2,{id:"see-also",children:"See Also"}),"\n",(0,o.jsxs)(c.ul,{children:["\n",(0,o.jsx)(c.li,{children:(0,o.jsx)(c.a,{href:"https://docs.docker.com/engine/reference/builder/#healthcheck",children:"Dockerfile reference"})}),"\n",(0,o.jsx)(c.li,{children:(0,o.jsx)(c.a,{href:"https://dockerlabs.collabnix.com/beginners/dockerfile/healthcheck.html",children:"Lab #14: Create a Docker Image with HEALTHCHECK instruction | dockerlabs"})}),"\n",(0,o.jsx)(c.li,{children:(0,o.jsx)(c.a,{href:"https://yeasy.gitbook.io/docker_practice/image/dockerfile/healthcheck",children:"HEALTHCHECK \u5065\u5eb7\u68c0\u67e5 - Docker \u2014 \u4ece\u5165\u95e8\u5230\u5b9e\u8df5"})}),"\n",(0,o.jsx)(c.li,{children:(0,o.jsx)(c.a,{href:"https://wshs0713.github.io/posts/b8226bad/",children:"[Docker] Health Check and Restart Unhealthy Container | wshs0713's blog"})}),"\n"]})]})}function a(e={}){const{wrapper:c}={...(0,t.a)(),...e.components};return c?(0,o.jsx)(c,{...e,children:(0,o.jsx)(h,{...e})}):h(e)}},11151:(e,c,n)=>{n.d(c,{Z:()=>i,a:()=>l});var o=n(67294);const t={},r=o.createContext(t);function l(e){const c=o.useContext(r);return o.useMemo((function(){return"function"==typeof e?e(c):{...c,...e}}),[c,e])}function i(e){let c;return c=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:l(e.components),o.createElement(r.Provider,{value:c},e.children)}}}]);