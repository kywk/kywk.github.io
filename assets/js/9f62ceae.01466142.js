"use strict";(self.webpackChunkkywk_me=self.webpackChunkkywk_me||[]).push([["48289"],{41522:function(e,n,s){s.r(n),s.d(n,{frontMatter:()=>d,toc:()=>c,default:()=>u,metadata:()=>l,assets:()=>t,contentTitle:()=>a});var l=JSON.parse('{"id":"javascript/package/Sequelize Migration Seeds","title":"Sequelize: Seeds","description":"Sequelize Seeds - \u8CC7\u6599\u5EAB\u6E2C\u8A66\u8CC7\u6599\u8207\u521D\u59CB\u8CC7\u6599\u7BA1\u7406","source":"@site/moco/javascript/package/Sequelize Migration Seeds.md","sourceDirName":"javascript/package","slug":"/javascript/package/sequelize-migration-seeds/","permalink":"/moco/javascript/package/sequelize-migration-seeds/","draft":false,"unlisted":false,"tags":[{"inline":true,"label":"Node.js","permalink":"/moco/tags/node-js"},{"inline":true,"label":"ORM","permalink":"/moco/tags/orm"},{"inline":true,"label":"Nodejs/Sequelize","permalink":"/moco/tags/nodejs-sequelize"}],"version":"current","frontMatter":{"title":"Sequelize: Seeds","description":"Sequelize Seeds - \u8CC7\u6599\u5EAB\u6E2C\u8A66\u8CC7\u6599\u8207\u521D\u59CB\u8CC7\u6599\u7BA1\u7406","tags":["Node.js","ORM","Nodejs/Sequelize"],"date_created":"2022-09-14T16:00:00.000Z","image":"https://lh3.googleusercontent.com/pw/AL9nZEUA9Ifvd5Z8SXDWkeVB6AC4MPGwnXaL6kBXNPoXwOQQ2jOcZ1Jw_0p8TKK8C3ZX0e67_FOY15eDrm7aaXSQJcKtoUzC80SAQEHsaBy6qS2AqNNs5VUFNXBKm439y_1wkvmDl-PnL8ReojnIumNlEvOXBg=w800-no?authuser=0","slug":"/javascript/package/sequelize-migration-seeds/"},"sidebar":"tutorialSidebar","previous":{"title":"Axios Snippets","permalink":"/moco/javascript/package/axios-snippets/"},"next":{"title":"Sequelize: Migration","permalink":"/moco/javascript/package/sequelize-migration/"}}'),i=s(74848),r=s(84429);let d={title:"Sequelize: Seeds",description:"Sequelize Seeds - \u8CC7\u6599\u5EAB\u6E2C\u8A66\u8CC7\u6599\u8207\u521D\u59CB\u8CC7\u6599\u7BA1\u7406",tags:["Node.js","ORM","Nodejs/Sequelize"],date_created:new Date("2022-09-14T16:00:00.000Z"),image:"https://lh3.googleusercontent.com/pw/AL9nZEUA9Ifvd5Z8SXDWkeVB6AC4MPGwnXaL6kBXNPoXwOQQ2jOcZ1Jw_0p8TKK8C3ZX0e67_FOY15eDrm7aaXSQJcKtoUzC80SAQEHsaBy6qS2AqNNs5VUFNXBKm439y_1wkvmDl-PnL8ReojnIumNlEvOXBg=w800-no?authuser=0",slug:"/javascript/package/sequelize-migration-seeds/"},a="[Node.js] Sequelize Seeds",t={},c=[{value:"\u4EC0\u9EBC\u662F Seeds ?",id:"\u4EC0\u9EBC\u662F-seeds-",level:2},{value:"\u4F7F\u7528\u5834\u666F",id:"\u4F7F\u7528\u5834\u666F",level:3},{value:"\u5EFA\u7ACB Seeder",id:"\u5EFA\u7ACB-seeder",level:2},{value:"\u7522\u751F Seeder \u6A94\u6848",id:"\u7522\u751F-seeder-\u6A94\u6848",level:3},{value:"\u57F7\u884C Seeders",id:"\u57F7\u884C-seeders",level:3},{value:"\u5FA9\u539F Seeders",id:"\u5FA9\u539F-seeders",level:3},{value:"Seeder \u6A94\u6848\u7D50\u69CB",id:"seeder-\u6A94\u6848\u7D50\u69CB",level:2},{value:"\u5E38\u7528\u65B9\u6CD5",id:"\u5E38\u7528\u65B9\u6CD5",level:3},{value:"\u5BE6\u7528\u7BC4\u4F8B",id:"\u5BE6\u7528\u7BC4\u4F8B",level:2},{value:"\u4F7F\u7528 Model \u5EFA\u7ACB\u8CC7\u6599",id:"\u4F7F\u7528-model-\u5EFA\u7ACB\u8CC7\u6599",level:3},{value:"\u689D\u4EF6\u5F0F\u522A\u9664",id:"\u689D\u4EF6\u5F0F\u522A\u9664",level:3},{value:"\u95DC\u806F\u8CC7\u6599\u7684 Seed",id:"\u95DC\u806F\u8CC7\u6599\u7684-seed",level:3},{value:"\u6CE8\u610F\u4E8B\u9805",id:"\u6CE8\u610F\u4E8B\u9805",level:2},{value:"Seeds \u4E0D\u6703\u81EA\u52D5\u8FFD\u8E64\u57F7\u884C\u72C0\u614B",id:"seeds-\u4E0D\u6703\u81EA\u52D5\u8FFD\u8E64\u57F7\u884C\u72C0\u614B",level:3},{value:"\u751F\u7522\u74B0\u5883\u4F7F\u7528\u5EFA\u8B70",id:"\u751F\u7522\u74B0\u5883\u4F7F\u7528\u5EFA\u8B70",level:3},{value:"See Also",id:"see-also",level:2},{value:"\u76F8\u95DC\u6587\u7AE0",id:"\u76F8\u95DC\u6587\u7AE0",level:3},{value:"Reference",id:"reference",level:3}];function o(e){let n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"nodejs-sequelize-seeds",children:"[Node.js] Sequelize Seeds"})}),"\n",(0,i.jsx)(n.p,{children:"Seeds \u662F Sequelize \u7528\u4F86\u7BA1\u7406\u6E2C\u8A66\u8CC7\u6599\u548C\u521D\u59CB\u8CC7\u6599\u7684\u6A5F\u5236\u3002\n\u900F\u904E Seeders\uFF0C\u53EF\u4EE5\u5FEB\u901F\u5EFA\u7ACB\u958B\u767C\u6216\u6E2C\u8A66\u74B0\u5883\u6240\u9700\u7684\u8CC7\u6599\uFF0C\u78BA\u4FDD\u5718\u968A\u6210\u54E1\u64C1\u6709\u4E00\u81F4\u7684\u8CC7\u6599\u72C0\u614B\u3002"}),"\n",(0,i.jsx)(n.h2,{id:"\u4EC0\u9EBC\u662F-seeds-",children:"\u4EC0\u9EBC\u662F Seeds ?"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Seeds"})," \u662F\u7528\u4F86\u586B\u5145\u8CC7\u6599\u5EAB\u521D\u59CB\u8CC7\u6599\u6216\u6E2C\u8A66\u8CC7\u6599\u7684\u6A94\u6848"]}),"\n",(0,i.jsx)(n.li,{children:"\u8207 Migration \u4E0D\u540C\uFF0CSeeds \u4E3B\u8981\u8655\u7406\u300C\u8CC7\u6599\u5167\u5BB9\u300D\u800C\u975E\u300C\u8CC7\u6599\u7D50\u69CB\u300D"}),"\n",(0,i.jsx)(n.li,{children:"\u9069\u5408\u7528\u65BC\u958B\u767C\u74B0\u5883\u3001\u6E2C\u8A66\u74B0\u5883\u7684\u8CC7\u6599\u6E96\u5099"}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"\u4F7F\u7528\u5834\u666F",children:"\u4F7F\u7528\u5834\u666F"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"\u958B\u767C\u74B0\u5883\u7684\u6E2C\u8A66\u8CC7\u6599"}),"\n",(0,i.jsx)(n.li,{children:"\u61C9\u7528\u7A0B\u5F0F\u7684\u521D\u59CB\u8CC7\u6599\uFF08\u5982\u9810\u8A2D\u7BA1\u7406\u54E1\u5E33\u865F\u3001\u7CFB\u7D71\u8A2D\u5B9A\uFF09"}),"\n",(0,i.jsx)(n.li,{children:"Demo \u5C55\u793A\u7528\u7684\u7BC4\u4F8B\u8CC7\u6599"}),"\n",(0,i.jsx)(n.li,{children:"\u55AE\u5143\u6E2C\u8A66\u6216\u6574\u5408\u6E2C\u8A66\u7684\u56FA\u5B9A\u8CC7\u6599\u96C6"}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"\u5EFA\u7ACB-seeder",children:"\u5EFA\u7ACB Seeder"}),"\n",(0,i.jsx)(n.h3,{id:"\u7522\u751F-seeder-\u6A94\u6848",children:"\u7522\u751F Seeder \u6A94\u6848"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"sequelize seed:generate --name demo-users\n"})}),"\n",(0,i.jsxs)(n.p,{children:["\u6703\u5728 ",(0,i.jsx)(n.code,{children:"seeders/"})," \u76EE\u9304\u4E0B\u7522\u751F\u6A94\u6848\uFF1A",(0,i.jsx)(n.code,{children:"<YYYYMMDDHHMMSS>-demo-users.js"})]}),"\n",(0,i.jsx)(n.h3,{id:"\u57F7\u884C-seeders",children:"\u57F7\u884C Seeders"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"# \u57F7\u884C\u6240\u6709 seeders\nsequelize db:seed:all\n\n# \u57F7\u884C\u7279\u5B9A seeder\nsequelize db:seed --seed <YYYYMMDDHHMMSS>-demo-users.js\n"})}),"\n",(0,i.jsx)(n.h3,{id:"\u5FA9\u539F-seeders",children:"\u5FA9\u539F Seeders"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"# \u5FA9\u539F\u6700\u8FD1\u4E00\u6B21\u7684 seeder\nsequelize db:seed:undo\n\n# \u5FA9\u539F\u7279\u5B9A seeder\nsequelize db:seed:undo --seed <YYYYMMDDHHMMSS>-demo-users.js\n\n# \u5FA9\u539F\u6240\u6709 seeders\nsequelize db:seed:undo:all\n"})}),"\n",(0,i.jsx)(n.h2,{id:"seeder-\u6A94\u6848\u7D50\u69CB",children:"Seeder \u6A94\u6848\u7D50\u69CB"}),"\n",(0,i.jsxs)(n.p,{children:["Seeder \u6A94\u6848\u540C\u6A23\u5305\u542B ",(0,i.jsx)(n.code,{children:"up()"})," \u548C ",(0,i.jsx)(n.code,{children:"down()"})," \u65B9\u6CD5\uFF1A"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-js",metastring:'title="seeders/<TIMESTAMP>-demo-users.js"',children:'"use strict";\n\nmodule.exports = {\n  up: async (queryInterface, Sequelize) => {\n    await queryInterface.bulkInsert(\n      "Users",\n      [\n        {\n          name: "John Doe",\n          email: "john@example.com",\n          createdAt: new Date(),\n          updatedAt: new Date(),\n        },\n        {\n          name: "Jane Smith",\n          email: "jane@example.com",\n          createdAt: new Date(),\n          updatedAt: new Date(),\n        },\n      ],\n      {},\n    );\n  },\n\n  down: async (queryInterface, Sequelize) => {\n    await queryInterface.bulkDelete("Users", null, {});\n  },\n};\n'})}),"\n",(0,i.jsx)(n.h3,{id:"\u5E38\u7528\u65B9\u6CD5",children:"\u5E38\u7528\u65B9\u6CD5"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"bulkInsert(tableName, records, options)"})," - \u6279\u6B21\u65B0\u589E\u8CC7\u6599"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"bulkDelete(tableName, where, options)"})," - \u6279\u6B21\u522A\u9664\u8CC7\u6599"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"bulkUpdate(tableName, values, where, options)"})," - \u6279\u6B21\u66F4\u65B0\u8CC7\u6599"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"\u5BE6\u7528\u7BC4\u4F8B",children:"\u5BE6\u7528\u7BC4\u4F8B"}),"\n",(0,i.jsx)(n.h3,{id:"\u4F7F\u7528-model-\u5EFA\u7ACB\u8CC7\u6599",children:"\u4F7F\u7528 Model \u5EFA\u7ACB\u8CC7\u6599"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-js",children:'const { User } = require("../models");\n\nmodule.exports = {\n  up: async (queryInterface, Sequelize) => {\n    await User.bulkCreate([\n      { name: "Admin", email: "admin@example.com", role: "admin" },\n      { name: "User", email: "user@example.com", role: "user" },\n    ]);\n  },\n\n  down: async (queryInterface, Sequelize) => {\n    await User.destroy({\n      where: { email: ["admin@example.com", "user@example.com"] },\n    });\n  },\n};\n'})}),"\n",(0,i.jsx)(n.h3,{id:"\u689D\u4EF6\u5F0F\u522A\u9664",children:"\u689D\u4EF6\u5F0F\u522A\u9664"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-js",children:'module.exports = {\n  down: async (queryInterface, Sequelize) => {\n    await queryInterface.bulkDelete(\n      "Users",\n      {\n        email: { [Sequelize.Op.like]: "%@example.com" },\n      },\n      {},\n    );\n  },\n};\n'})}),"\n",(0,i.jsx)(n.h3,{id:"\u95DC\u806F\u8CC7\u6599\u7684-seed",children:"\u95DC\u806F\u8CC7\u6599\u7684 Seed"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-js",children:'module.exports = {\n  up: async (queryInterface, Sequelize) => {\n    // \u5148\u5EFA\u7ACB Users\n    const users = await queryInterface.bulkInsert(\n      "Users",\n      [\n        {\n          name: "John",\n          email: "john@example.com",\n          createdAt: new Date(),\n          updatedAt: new Date(),\n        },\n      ],\n      { returning: true },\n    );\n\n    // \u518D\u5EFA\u7ACB\u95DC\u806F\u7684 Posts\n    await queryInterface.bulkInsert(\n      "Posts",\n      [\n        {\n          title: "First Post",\n          content: "Hello World",\n          userId: users[0].id,\n          createdAt: new Date(),\n          updatedAt: new Date(),\n        },\n      ],\n      {},\n    );\n  },\n\n  down: async (queryInterface, Sequelize) => {\n    await queryInterface.bulkDelete("Posts", null, {});\n    await queryInterface.bulkDelete("Users", null, {});\n  },\n};\n'})}),"\n",(0,i.jsx)(n.h2,{id:"\u6CE8\u610F\u4E8B\u9805",children:"\u6CE8\u610F\u4E8B\u9805"}),"\n",(0,i.jsx)(n.h3,{id:"seeds-\u4E0D\u6703\u81EA\u52D5\u8FFD\u8E64\u57F7\u884C\u72C0\u614B",children:"Seeds \u4E0D\u6703\u81EA\u52D5\u8FFD\u8E64\u57F7\u884C\u72C0\u614B"}),"\n",(0,i.jsxs)(n.p,{children:["\u8207 Migration \u4E0D\u540C\uFF0CSequelize \u9810\u8A2D\u4E0D\u6703\u8FFD\u8E64\u54EA\u4E9B Seeds \u5DF2\u7D93\u57F7\u884C\u904E\u3002\n\u9019\u610F\u5473\u8457\u57F7\u884C ",(0,i.jsx)(n.code,{children:"db:seed:all"})," \u53EF\u80FD\u6703\u91CD\u8907\u63D2\u5165\u8CC7\u6599\u3002"]}),"\n",(0,i.jsx)(n.p,{children:"\u89E3\u6C7A\u65B9\u6848\uFF1A"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"\u5728 Seeder \u4E2D\u52A0\u5165\u6AA2\u67E5\u908F\u8F2F\uFF0C\u907F\u514D\u91CD\u8907\u63D2\u5165"}),"\n",(0,i.jsxs)(n.li,{children:["\u4F7F\u7528 ",(0,i.jsx)(n.code,{children:"db:seed:undo:all"})," \u6E05\u7A7A\u5F8C\u518D\u91CD\u65B0\u57F7\u884C"]}),"\n",(0,i.jsxs)(n.li,{children:["\u8003\u616E\u4F7F\u7528 ",(0,i.jsx)(n.a,{href:"https://github.com/manuelbieh/sequelize-cli-typescript",children:"sequelize-cli-typescript"})," \u7B49\u64F4\u5145\u5957\u4EF6"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"\u751F\u7522\u74B0\u5883\u4F7F\u7528\u5EFA\u8B70",children:"\u751F\u7522\u74B0\u5883\u4F7F\u7528\u5EFA\u8B70"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Seeds \u4E3B\u8981\u7528\u65BC\u958B\u767C\u548C\u6E2C\u8A66\u74B0\u5883"}),"\n",(0,i.jsx)(n.li,{children:"\u751F\u7522\u74B0\u5883\u7684\u521D\u59CB\u8CC7\u6599\u5EFA\u8B70\u900F\u904E Migration \u6216\u5C08\u9580\u7684\u90E8\u7F72\u8173\u672C\u8655\u7406"}),"\n",(0,i.jsxs)(n.li,{children:["\u907F\u514D\u5728\u751F\u7522\u74B0\u5883\u57F7\u884C ",(0,i.jsx)(n.code,{children:"db:seed:undo:all"}),"\uFF0C\u53EF\u80FD\u6703\u6E05\u7A7A\u91CD\u8981\u8CC7\u6599"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"see-also",children:"See Also"}),"\n",(0,i.jsx)(n.h3,{id:"\u76F8\u95DC\u6587\u7AE0",children:"\u76F8\u95DC\u6587\u7AE0"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.a,{className:"internal new",href:"/moco/javascript/package/sequelize-migration/",children:"Sequelize Migration"})," - \u8CC7\u6599\u5EAB\u7D50\u69CB\u8B8A\u66F4\u7BA1\u7406"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"reference",children:"Reference"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"https://sequelize.org/docs/v6/other-topics/migrations/",children:"Migrations | Sequelize"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"https://sequelize.org/docs/v6/other-topics/query-interface/",children:"Query Interface | Sequelize"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"https://github.com/sequelize/cli",children:"Sequelize CLI Documentation"})}),"\n"]})]})}function u(e={}){let{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(o,{...e})}):o(e)}},84429:function(e,n,s){s.d(n,{R:()=>d,x:()=>a});var l=s(96540);let i={},r=l.createContext(i);function d(e){let n=l.useContext(r);return l.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:d(e.components),l.createElement(r.Provider,{value:n},e.children)}}}]);