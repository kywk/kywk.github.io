"use strict";(self.webpackChunkkywk_me=self.webpackChunkkywk_me||[]).push([["37189"],{23002:function(e,t,i){i.r(t),i.d(t,{frontMatter:()=>s,toc:()=>a,default:()=>d,metadata:()=>n,assets:()=>c,contentTitle:()=>l});var n=JSON.parse('{"id":"utilities/Git/Git Check remote branch","title":"Git: Check Remote Branch","description":"How to check if a remote branch exists on a given remote repository using git ls-remote","source":"@site/moco/utilities/Git/Git Check remote branch.md","sourceDirName":"utilities/Git","slug":"/utilities/git/git-check-remote-branch/","permalink":"/moco/utilities/git/git-check-remote-branch/","draft":false,"unlisted":false,"tags":[{"inline":true,"label":"Git","permalink":"/moco/tags/git"},{"inline":true,"label":"CLI","permalink":"/moco/tags/cli"},{"inline":true,"label":"Tips","permalink":"/moco/tags/tips"}],"version":"current","sidebarPosition":62,"frontMatter":{"title":"Git: Check Remote Branch","description":"How to check if a remote branch exists on a given remote repository using git ls-remote","tags":["Git","CLI","Tips"],"sidebar_position":62,"hide_table_of_contents":true,"date_created":"2021-04-12T07:13:11.000Z","date_updated":"2024-01-01T00:00:00.000Z","image":"https://lh3.googleusercontent.com/pw/ACtC-3djQkrvy1aqdMWCu9oEoqndQVIiLE9G5ZtlbDehi8_UcJ9pYib4aWForkHYHSu1voqdKMnCowTwGh1MXSnGeNrFwXRaOUCMD8s4rCZ4IuzWXIZ2khQ8KiJyT6SYlbLrnYYqONwaPZxlR8rReuWWMO7SYw=w8000-no?authuser=0","slug":"/utilities/git/git-check-remote-branch/"},"sidebar":"tutorialSidebar","previous":{"title":"Git: Add Empty Folder","permalink":"/moco/utilities/git/git-add-empty-folder/"},"next":{"title":"Visual Studio Code","permalink":"/moco/category/visual-studio-code"}}'),r=i(74848),o=i(84429);let s={title:"Git: Check Remote Branch",description:"How to check if a remote branch exists on a given remote repository using git ls-remote",tags:["Git","CLI","Tips"],sidebar_position:62,hide_table_of_contents:!0,date_created:new Date("2021-04-12T07:13:11.000Z"),date_updated:new Date("2024-01-01T00:00:00.000Z"),image:"https://lh3.googleusercontent.com/pw/ACtC-3djQkrvy1aqdMWCu9oEoqndQVIiLE9G5ZtlbDehi8_UcJ9pYib4aWForkHYHSu1voqdKMnCowTwGh1MXSnGeNrFwXRaOUCMD8s4rCZ4IuzWXIZ2khQ8KiJyT6SYlbLrnYYqONwaPZxlR8rReuWWMO7SYw=w8000-no?authuser=0",slug:"/utilities/git/git-check-remote-branch/"},l="Git: Check Remote Branch",c={},a=[{value:"\u4F7F\u7528\u60C5\u5883",id:"\u4F7F\u7528\u60C5\u5883",level:2},{value:"\u89E3\u6C7A\u65B9\u6848",id:"\u89E3\u6C7A\u65B9\u6848",level:2},{value:"\u5B98\u65B9\u8AAA\u660E",id:"\u5B98\u65B9\u8AAA\u660E",level:3},{value:"Unix-like Shell",id:"unix-like-shell",level:3},{value:"PowerShell",id:"powershell",level:3},{value:"\u9032\u968E\u7528\u6CD5",id:"\u9032\u968E\u7528\u6CD5",level:2},{value:"\u6AA2\u67E5\u591A\u500B\u9060\u7AEF",id:"\u6AA2\u67E5\u591A\u500B\u9060\u7AEF",level:3},{value:"\u5728 CI/CD \u4E2D\u4F7F\u7528",id:"\u5728-cicd-\u4E2D\u4F7F\u7528",level:3},{value:"\u76F8\u95DC\u6307\u4EE4",id:"\u76F8\u95DC\u6307\u4EE4",level:2},{value:"\u53C3\u8003\u8CC7\u6599",id:"\u53C3\u8003\u8CC7\u6599",level:2}];function h(e){let t={a:"a",blockquote:"blockquote",br:"br",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,o.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(t.header,{children:(0,r.jsx)(t.h1,{id:"git-check-remote-branch",children:"Git: Check Remote Branch"})}),"\n",(0,r.jsxs)(t.blockquote,{children:["\n",(0,r.jsx)(t.p,{children:"\u5982\u4F55\u6AA2\u67E5\u9060\u7AEF\u5206\u652F\u662F\u5426\u5B58\u5728\u65BC\u6307\u5B9A\u7684\u9060\u7AEF\u5009\u5EAB\uFF1F"}),"\n"]}),"\n",(0,r.jsx)(t.h2,{id:"\u4F7F\u7528\u60C5\u5883",children:"\u4F7F\u7528\u60C5\u5883"}),"\n",(0,r.jsx)(t.p,{children:"\u5C08\u6848\u8981\u5E6B\u4E00\u4E9B\u820A\u9805\u76EE\u5C0E\u5165 GitLab CI/CD\uFF0C\u6848\u4F8B\u662F\u6709\u591A\u500B\u9805\u76EE\u9700\u53C3\u8003\u53E6\u4E00\u500B Git \u5171\u7528\u5143\u4EF6\u9805\u76EE\uFF0C\u901A\u5E38\u6703\u7528 Git SubModule \u4F86\u5F15\u7528\u5171\u7528\u5143\u4EF6\u9805\u76EE\u3002\u4F46\u56E0\u820A\u9805\u76EE\u65E2\u6709\u958B\u767C\u6D41\u7A0B\u8207\u7248\u63A7\u7BA1\u7406\u5DF2\u4E45\uFF0C\u6709\u4E9B\u9700\u6C42\u5BE6\u4F5C\u5C31\u96E3\u4EE5\u8F03\u6B63\u78BA\u7684\u65B9\u5F0F\u9032\u884C\u3002"}),"\n",(0,r.jsx)(t.p,{children:"\u8A72\u6848\u4F8B\u4E2D\u7684\u7BA1\u7406\u6D41\u7A0B\u662F\uFF1A"}),"\n",(0,r.jsxs)(t.ul,{children:["\n",(0,r.jsxs)(t.li,{children:["\u958B\u767C\u6642\uFF0C\u4E3B\u8981\u529F\u80FD\u548C\u5171\u7528\u5143\u4EF6\u9805\u76EE\u90FD\u5EFA\u7ACB\u76F8\u540C\u540D\u7A31\u7684 branch\uFF08\u4F8B\u5982\uFF1A",(0,r.jsx)(t.code,{children:"BR-A001"}),"\uFF09"]}),"\n",(0,r.jsxs)(t.li,{children:["\u82E5\u5171\u7528\u5143\u4EF6\u6709\u66F4\u65B0\uFF0C\u5247 build \u6642\u9700 checkout \u5171\u7528\u5143\u4EF6\u7684 ",(0,r.jsx)(t.code,{children:"BR-A001"})," \u5206\u652F\u9032\u884C\u7DE8\u8B6F"]}),"\n",(0,r.jsxs)(t.li,{children:["\u82E5\u5171\u7528\u5143\u4EF6\u6C92\u6709\u66F4\u65B0\uFF0C\u5247\u4EE5 ",(0,r.jsx)(t.code,{children:"master"})," \u70BA\u4E3B"]}),"\n"]}),"\n",(0,r.jsx)(t.p,{children:"\u56E0\u6B64\uFF0C\u9700\u5728\u547D\u4EE4\u5217\u6A21\u5F0F\u4E0B\u77E5\u9053\u67D0\u500B\u7279\u5B9A\u540D\u7A31\u7684 Branch \u662F\u5426\u5B58\u5728\u3002"}),"\n",(0,r.jsx)(t.h2,{id:"\u89E3\u6C7A\u65B9\u6848",children:"\u89E3\u6C7A\u65B9\u6848"}),"\n",(0,r.jsxs)(t.p,{children:["\u4F7F\u7528 ",(0,r.jsx)(t.code,{children:"git ls-remote"})," \u914D\u5408 ",(0,r.jsx)(t.code,{children:"--exit-code"})," \u53EF\u4EE5\u5F97\u77E5\u67D0\u500B branch-name \u662F\u5426\u5B58\u5728\u9060\u7AEF repos \u4E0A\u3002"]}),"\n",(0,r.jsx)(t.h3,{id:"\u5B98\u65B9\u8AAA\u660E",children:"\u5B98\u65B9\u8AAA\u660E"}),"\n",(0,r.jsxs)(t.p,{children:["\u6839\u64DA ",(0,r.jsx)(t.a,{href:"https://git-scm.com/docs/git-ls-remote",children:"Git \u5B98\u65B9\u6587\u4EF6"}),"\uFF1A"]}),"\n",(0,r.jsxs)(t.blockquote,{children:["\n",(0,r.jsxs)(t.p,{children:[(0,r.jsx)(t.code,{children:"--exit-code"}),(0,r.jsx)(t.br,{}),'\nExit with status "2" when no matching refs are found in the remote repository. Usually the command exits with status "0" to indicate it successfully talked with the remote repository, whether it found any matching refs.']}),"\n"]}),"\n",(0,r.jsx)(t.h3,{id:"unix-like-shell",children:"Unix-like Shell"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-bash",children:'# \u6AA2\u67E5\u5B58\u5728\u7684\u5206\u652F - \u56DE\u50B3 0\ngit ls-remote --exit-code --heads origin <branch-that-exists-in-origin>\n\n# \u6AA2\u67E5\u4E0D\u5B58\u5728\u7684\u5206\u652F - \u56DE\u50B3 2\ngit ls-remote --exit-code --heads origin <branch-that-not-exists-origin>\n\n# \u5BE6\u969B\u4F7F\u7528\u7BC4\u4F8B\nif git ls-remote --exit-code --heads origin feature/new-feature >/dev/null 2>&1; then\n    echo "\u5206\u652F\u5B58\u5728"\n    git checkout feature/new-feature\nelse\n    echo "\u5206\u652F\u4E0D\u5B58\u5728\uFF0C\u4F7F\u7528 master"\n    git checkout master\nfi\n'})}),"\n",(0,r.jsx)(t.h3,{id:"powershell",children:"PowerShell"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-powershell",children:'# \u6AA2\u67E5\u5206\u652F\u662F\u5426\u5B58\u5728\nif (git ls-remote --exit-code --heads origin <branch-name>) {\n    Write-Host "\u5206\u652F\u5B58\u5728"\n    $true\n} else {\n    Write-Host "\u5206\u652F\u4E0D\u5B58\u5728"\n    $false\n}\n\n# \u5BE6\u969B\u4F7F\u7528\u7BC4\u4F8B\n$branchName = "feature/new-feature"\nif (git ls-remote --exit-code --heads origin $branchName) {\n    git checkout $branchName\n} else {\n    git checkout master\n}\n'})}),"\n",(0,r.jsx)(t.h2,{id:"\u9032\u968E\u7528\u6CD5",children:"\u9032\u968E\u7528\u6CD5"}),"\n",(0,r.jsx)(t.h3,{id:"\u6AA2\u67E5\u591A\u500B\u9060\u7AEF",children:"\u6AA2\u67E5\u591A\u500B\u9060\u7AEF"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-bash",children:'# \u6AA2\u67E5\u7279\u5B9A\u9060\u7AEF\ngit ls-remote --exit-code --heads upstream feature-branch\n\n# \u6AA2\u67E5\u6240\u6709\u9060\u7AEF\u7684\u5206\u652F\ngit ls-remote --heads origin | grep "feature-branch"\n'})}),"\n",(0,r.jsx)(t.h3,{id:"\u5728-cicd-\u4E2D\u4F7F\u7528",children:"\u5728 CI/CD \u4E2D\u4F7F\u7528"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-yaml",children:'# GitLab CI \u7BC4\u4F8B\ncheck_branch:\n  script:\n    - |\n      if git ls-remote --exit-code --heads origin $CI_COMMIT_REF_NAME; then\n        echo "\u4F7F\u7528\u5C0D\u61C9\u5206\u652F: $CI_COMMIT_REF_NAME"\n        git checkout $CI_COMMIT_REF_NAME\n      else\n        echo "\u5206\u652F\u4E0D\u5B58\u5728\uFF0C\u4F7F\u7528 master"\n        git checkout master\n      fi\n'})}),"\n",(0,r.jsx)(t.h2,{id:"\u76F8\u95DC\u6307\u4EE4",children:"\u76F8\u95DC\u6307\u4EE4"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-bash",children:"# \u5217\u51FA\u6240\u6709\u9060\u7AEF\u5206\u652F\ngit ls-remote --heads origin\n\n# \u5217\u51FA\u6240\u6709\u9060\u7AEF\u6A19\u7C64\ngit ls-remote --tags origin\n\n# \u6AA2\u67E5\u7279\u5B9A\u6A19\u7C64\u662F\u5426\u5B58\u5728\ngit ls-remote --exit-code --tags origin v1.0.0\n\n# \u975C\u9ED8\u6A21\u5F0F\uFF08\u4E0D\u986F\u793A\u8F38\u51FA\uFF09\ngit ls-remote --exit-code --heads origin branch-name >/dev/null 2>&1\n"})}),"\n",(0,r.jsx)(t.h2,{id:"\u53C3\u8003\u8CC7\u6599",children:"\u53C3\u8003\u8CC7\u6599"}),"\n",(0,r.jsxs)(t.ul,{children:["\n",(0,r.jsx)(t.li,{children:(0,r.jsx)(t.a,{href:"https://git-scm.com/docs/git-ls-remote",children:"Git ls-remote \u5B98\u65B9\u6587\u4EF6"})}),"\n",(0,r.jsx)(t.li,{children:(0,r.jsx)(t.a,{href:"https://stackoverflow.com/questions/8223906/how-to-check-if-remote-branch-exists-on-a-given-remote-repository",children:"How to check if remote branch exists on a given remote repository? - Stack Overflow"})}),"\n"]})]})}function d(e={}){let{wrapper:t}={...(0,o.R)(),...e.components};return t?(0,r.jsx)(t,{...e,children:(0,r.jsx)(h,{...e})}):h(e)}},84429:function(e,t,i){i.d(t,{R:()=>s,x:()=>l});var n=i(96540);let r={},o=n.createContext(r);function s(e){let t=n.useContext(o);return n.useMemo(function(){return"function"==typeof e?e(t):{...t,...e}},[t,e])}function l(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:s(e.components),n.createElement(o.Provider,{value:t},e.children)}}}]);