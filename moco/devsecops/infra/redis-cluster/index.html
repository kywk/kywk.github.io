<!doctype html><html lang=zh-TW dir=ltr class="docs-wrapper plugin-docs plugin-id-moco docs-version-current docs-doc-page docs-doc-id-devsecops/infra/Redis Cluster" data-has-hydrated=false><head><meta charset=UTF-8><meta name=generator content="Docusaurus v3.9.2"><title data-rh=true>Redis: Cluster 建製 | kywk.me</title><meta data-rh=true name=viewport content="width=device-width, initial-scale=1.0"/><meta data-rh=true property=og:url content=https://kywk.github.io/moco/devsecops/infra/redis-cluster/ /><meta data-rh=true property=og:locale content=zh_TW /><meta data-rh=true name=docusaurus_locale content=zh-TW /><meta data-rh=true name=docsearch:language content=zh-TW /><meta data-rh=true name=keywords content="旅行, 背包客, 生活效率, 工程筆記, DevSecOps, Obsidian"/><meta data-rh=true name=author content=kywk /><meta data-rh=true property=og:type content=website /><meta data-rh=true property=og:site_name content=kywk.me /><meta data-rh=true name=twitter:card content=summary_large_image /><meta data-rh=true name=docusaurus_version content=current /><meta data-rh=true name=docusaurus_tag content=docs-moco-current /><meta data-rh=true name=docsearch:version content=current /><meta data-rh=true name=docsearch:docusaurus_tag content=docs-moco-current /><meta data-rh=true property=og:title content="Redis: Cluster 建製 | kywk.me"/><meta data-rh=true name=description content="Redis-Cluster 為無中心化架構, 每個節點都會儲存數據以及整個叢集狀態, 每個節點都會和其他節點建立連線."/><meta data-rh=true property=og:description content="Redis-Cluster 為無中心化架構, 每個節點都會儲存數據以及整個叢集狀態, 每個節點都會和其他節點建立連線."/><meta data-rh=true property=og:image content="https://lh3.googleusercontent.com/pw/ACtC-3fIlrxgO6AX1o_tNuiD0YfrwpojgHUZa_OSpR36XoOZ_Ojz9q0Bw9yZ2V9QwSKUqApRMEIPWetv9AQd4TsfGgE0AaZXj7IJ2NV6ffvWj7N_Fjo2EzJ7BaCjZ7Fxx702zh6ZnykZAOChtRM-P1Zr9t0SYQ=w800-no?authuser=0"/><meta data-rh=true name=twitter:image content="https://lh3.googleusercontent.com/pw/ACtC-3fIlrxgO6AX1o_tNuiD0YfrwpojgHUZa_OSpR36XoOZ_Ojz9q0Bw9yZ2V9QwSKUqApRMEIPWetv9AQd4TsfGgE0AaZXj7IJ2NV6ffvWj7N_Fjo2EzJ7BaCjZ7Fxx702zh6ZnykZAOChtRM-P1Zr9t0SYQ=w800-no?authuser=0"/><link data-rh=true rel=icon href=/img/favicon.ico /><link data-rh=true rel=canonical href=https://kywk.github.io/moco/devsecops/infra/redis-cluster/ /><link data-rh=true rel=alternate href=https://kywk.github.io/moco/devsecops/infra/redis-cluster/ hreflang=zh-TW /><link data-rh=true rel=alternate href=https://kywk.github.io/moco/devsecops/infra/redis-cluster/ hreflang=x-default /><script data-rh=true type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","item":"https://kywk.github.io/moco/category/devsecops","name":"DevSecOps","position":1},{"@type":"ListItem","item":"https://kywk.github.io/moco/category/sre","name":"SRE","position":2},{"@type":"ListItem","item":"https://kywk.github.io/moco/devsecops/infra/redis-cluster/","name":"Redis: Cluster 建製","position":3}]}</script><link rel=alternate type=application/rss+xml href=/news/rss.xml title="kywk.me RSS Feed"><link rel=alternate type=application/atom+xml href=/news/atom.xml title="kywk.me Atom Feed"><link rel=alternate type=application/rss+xml href=/life/rss.xml title="kywk.me RSS Feed"><link rel=alternate type=application/atom+xml href=/life/atom.xml title="kywk.me Atom Feed"><link rel=stylesheet href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500&family=Noto+Sans+TC:wght@400;500;700&display=swap" type=text/css><link rel=stylesheet href=https://unpkg.com/leaflet@1.9.4/dist/leaflet.css type=text/css><script src=https://unpkg.com/leaflet@1.9.4/dist/leaflet.js></script><script src=/js/leaflet-init.js></script><link rel=stylesheet href=/assets/css/styles.51adb6cf.css /><script src=/assets/js/runtime~main.18640008.js defer></script><script src=/assets/js/main.05713bfb.js defer></script></head><body class=navigation-with-keyboard><svg style="display: none;"><defs>
<symbol id=theme-svg-external-link viewBox="0 0 24 24"><path fill=currentColor d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",t||"light"),document.documentElement.setAttribute("data-theme-choice",t||"light")}(),function(){try{for(var[t,e]of new URLSearchParams(window.location.search).entries())if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id=__docusaurus><link rel=preload as=image href=/img/logo.svg /><div role=region aria-label=跳至主要内容><a class=skipToContent_fXgn href=#__docusaurus_skipToContent_fallback>跳至主要内容</a></div><nav aria-label=主導航 class="theme-layout-navbar navbar navbar--fixed-top"><div class=navbar__inner><div class="theme-layout-navbar-left navbar__items"><button aria-label=切換導覽列 aria-expanded=false class="navbar__toggle clean-btn" type=button><svg width=30 height=30 viewBox="0 0 30 30" aria-hidden=true><path stroke=currentColor stroke-linecap=round stroke-miterlimit=10 stroke-width=2 d="M4 7h22M4 15h22M4 23h22"/></svg></button><a class=navbar__brand href=/><div class=navbar__logo><img src=/img/logo.svg alt="kywk.me Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"/><img src=/img/logo.svg alt="kywk.me Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"/></div><b class="navbar__title text--truncate">kywk.me</b></a><a class="navbar__item navbar__link" href=/backpacker/lonely-planet/>lonely planet</a><a class="navbar__item navbar__link" href=/lifehacker/way-2-kywk/>lifehacker</a><a aria-current=page class="navbar__item navbar__link navbar__link--active" href=/moco/kywk.moco/>moco</a><a class="navbar__item navbar__link" href=/life/>life</a><a class="navbar__item navbar__link" href=/news/>news</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><a href=https://github.com/kywk/ target=_blank rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width=13.5 height=13.5 aria-label="(opens in new tab)" class=iconExternalLink_nPIU><use href=#theme-svg-external-link /></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type=button disabled title="system mode" aria-label="切換淺色/深色模式（當前為system mode）"><svg viewBox="0 0 24 24" width=24 height=24 aria-hidden=true class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill=currentColor d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"/></svg><svg viewBox="0 0 24 24" width=24 height=24 aria-hidden=true class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill=currentColor d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"/></svg><svg viewBox="0 0 24 24" width=24 height=24 aria-hidden=true class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill=currentColor d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"/></svg></button></div><div class=navbarSearchContainer_Bca1></div></div></div><div role=presentation class=navbar-sidebar__backdrop></div></nav><div id=__docusaurus_skipToContent_fallback class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class=docsWrapper_hBAB><button aria-label=回到頂部 class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type=button></button><div class=docRoot_UBD9><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class=sidebarViewport_aRkj><div class=sidebar_njMd><nav aria-label=文件側邊欄 class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_byQd menu__link menu__link--sublist" href=/moco/52-projects/52-projects/><span title="52 Projects" class=categoryLinkLabel_W154>52 Projects</span></a><button aria-label="展開側邊欄分類 '52 Projects'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_byQd menu__link menu__link--sublist" href=/moco/category/life-with-ai/><span title="Life with AI" class=categoryLinkLabel_W154>Life with AI</span></a><button aria-label="展開側邊欄分類 'Life with AI'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_byQd menu__link menu__link--sublist" href=/moco/category/bootcamp/><span title=BOOTCAMP class=categoryLinkLabel_W154>BOOTCAMP</span></a><button aria-label="展開側邊欄分類 'BOOTCAMP'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_byQd menu__link menu__link--sublist" href=/moco/category/tech-stack/><span title="Tech Stack" class=categoryLinkLabel_W154>Tech Stack</span></a><button aria-label="展開側邊欄分類 'Tech Stack'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class=menu__list-item-collapsible><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--active" href=/moco/category/devsecops/><span title=DevSecOps class=categoryLinkLabel_W154>DevSecOps</span></a><button aria-label="收起側邊欄分類 'DevSecOps'" aria-expanded=true type=button class="clean-btn menu__caret"></button></div><ul class=menu__list><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/moco/devsecops/awesome-elk/><span title="Awesome ELK" class=linkLabel_WmDU>Awesome ELK</span></a><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex=0 href=/moco/category/docker/><span title=Docker class=categoryLinkLabel_W154>Docker</span></a><button aria-label="展開側邊欄分類 'Docker'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex=0 href=/moco/category/gitlab/><span title=GitLab class=categoryLinkLabel_W154>GitLab</span></a><button aria-label="展開側邊欄分類 'GitLab'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class=menu__list-item-collapsible><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--active" tabindex=0 href=/moco/category/sre/><span title=SRE class=categoryLinkLabel_W154>SRE</span></a><button aria-label="收起側邊欄分類 'SRE'" aria-expanded=true type=button class="clean-btn menu__caret"></button></div><ul class=menu__list><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/moco/devsecops/infra/nexus-repository/><span title="Bash: snippets" class=linkLabel_WmDU>Bash: snippets</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/moco/devsecops/infra/nginx-docker-tips/><span title="NGINX: container tips" class=linkLabel_WmDU>NGINX: container tips</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href="/moco/devsecops/infra/nginx-let's-encrypt-ssl/"><span title="NGINX: Let's Encrypt SSL" class=linkLabel_WmDU>NGINX: Let's Encrypt SSL</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/moco/devsecops/infra/nginx-modify-endpoint/><span title="NGINX: changes URI" class=linkLabel_WmDU>NGINX: changes URI</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/moco/devsecops/infra/nginx-snippets/><span title="NGINX: Snippets" class=linkLabel_WmDU>NGINX: Snippets</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current=page tabindex=0 href=/moco/devsecops/infra/redis-cluster/><span title="Redis: Cluster 建製" class=linkLabel_WmDU>Redis: Cluster 建製</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/moco/devsecops/infra/redis-troubleshooting/><span title="Redis: 警告與問題排除" class=linkLabel_WmDU>Redis: 警告與問題排除</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/moco/devsecops/infra/ubuntu-nginx-php/><span title="Ubuntu: NGINX + PHP" class=linkLabel_WmDU>Ubuntu: NGINX + PHP</span></a></ul><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex=0 href=/moco/category/security/><span title=Security class=categoryLinkLabel_W154>Security</span></a><button aria-label="展開側邊欄分類 'Security'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div></ul><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_byQd menu__link menu__link--sublist" href=/moco/category/go/><span title=Go class=categoryLinkLabel_W154>Go</span></a><button aria-label="展開側邊欄分類 'Go'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_byQd menu__link menu__link--sublist" href=/moco/category/javascript/><span title=JavaScript class=categoryLinkLabel_W154>JavaScript</span></a><button aria-label="展開側邊欄分類 'JavaScript'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_byQd menu__link menu__link--sublist" href=/moco/category/java/><span title=Java class=categoryLinkLabel_W154>Java</span></a><button aria-label="展開側邊欄分類 'Java'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_byQd menu__link menu__link--sublist" href=/moco/category/utilities/><span title=Utilities class=categoryLinkLabel_W154>Utilities</span></a><button aria-label="展開側邊欄分類 'Utilities'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_byQd menu__link menu__link--sublist" href=/moco/category/machintosh/><span title=Machintosh class=categoryLinkLabel_W154>Machintosh</span></a><button aria-label="展開側邊欄分類 'Machintosh'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_byQd menu__link menu__link--sublist" href=/moco/category/obsidian/><span title=Obsidian class=categoryLinkLabel_W154>Obsidian</span></a><button aria-label="展開側邊欄分類 'Obsidian'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_byQd menu__link menu__link--sublist" href=/moco/category/miscellaneous/><span title=Miscellaneous class=categoryLinkLabel_W154>Miscellaneous</span></a><button aria-label="展開側邊欄分類 'Miscellaneous'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class=menu__link href=/moco/kywk.moco/><span title=kywk.moco class=linkLabel_WmDU>kywk.moco</span></a></ul></nav><button type=button title=收起側邊欄 aria-label=收起側邊欄 class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width=20 height=20 aria-hidden=true class=collapseSidebarButtonIcon_kv0_><g fill=#7a7a7a><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"/><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"/></g></svg></button></div></div></aside><main class=docMainContainer_TBSr><div class="container padding-top--md padding-bottom--lg"><div class=row><div class="col docItemCol_z5aJ"><div class=docItemContainer_c0TR><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label=頁面路徑><ul class=breadcrumbs><li class=breadcrumbs__item><a aria-label=主頁面 class=breadcrumbs__link href=/><svg viewBox="0 0 24 24" class=breadcrumbHomeIcon_YNFT><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill=currentColor /></svg></a><li class=breadcrumbs__item><a class=breadcrumbs__link href=/moco/category/devsecops/><span>DevSecOps</span></a><li class=breadcrumbs__item><a class=breadcrumbs__link href=/moco/category/sre/><span>SRE</span></a><li class="breadcrumbs__item breadcrumbs__item--active"><span class=breadcrumbs__link>Redis: Cluster 建製</span></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type=button class="clean-btn tocCollapsibleButton_TO0P">本頁導覽</button></div><div class="theme-doc-markdown markdown"><header><h1>[Redis] 建製 Redis Cluster</h1></header>
<p>Redis-Cluster 為無中心化架構, 每個節點都會儲存數據以及整個叢集狀態, 每個節點都會和其他節點建立連線.
一組 Redis Cluster 由多個獨立 Redis 節點組成,
官方建議六個節點, 其中三個為主節點 (master) 三個為從節點 (slave).</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id=安裝-redis>安裝 Redis<a href=#安裝-redis class=hash-link aria-label="安裝 Redis的直接連結" title="安裝 Redis的直接連結" translate=no>​</a></h2>
<p>略. 可透過不同系統的套件管理程式安裝, 或參考<a href=https://redis.io/download target=_blank rel="noopener noreferrer" class="">官方文件</a>下載 source tar ball 編譯安裝.</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">$ wget https://download.redis.io/releases/redis-6.2.3.tar.gz</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">$ tar xzf redis-6.2.3.tar.gz</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">$ cd redis-6.2.3</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">$ make</span><br/></span></code></pre></div></div>
<p>編譯後執行檔在 <code>src/redis-server</code>, 可試著執行開啟 redis 服務.</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">cow@sandbox:~/tmp/redis/src# ./redis-server</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">25572:C 06 May 2021 07:58:52.254 # oO0OoO0OoO0Oo Redis is starting oO0OoO0OoO0Oo</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">25572:C 06 May 2021 07:58:52.254 # Redis version=5.0.5, bits=64, commit=00000000, modified=0, pid=25572, just started</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">25572:C 06 May 2021 07:58:52.254 # Warning: no config file specified, using the default config. In order to specify a config file use ./redis-server /path/to/redis.conf</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">25572:M 06 May 2021 07:58:52.255 * Increased maximum number of open files to 10032 (it was originally set to 1024).</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">                _._</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">           _.-``__ ''-._</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">      _.-``    `.  `_.  ''-._           Redis 5.0.5 (00000000/0) 64 bit</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  .-`` .-```.  ```\/    _.,_ ''-._</span><br/></span><span class=token-line style=color:#393A34><span class="token plain"> (    '      ,       .-`  | `,    )     Running in standalone mode</span><br/></span><span class=token-line style=color:#393A34><span class="token plain"> |`-._`-...-` __...-.``-._|'` _.-'|     Port: 6379</span><br/></span><span class=token-line style=color:#393A34><span class="token plain"> |    `-._   `._    /     _.-'    |     PID: 25572</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  `-._    `-._  `-./  _.-'    _.-'</span><br/></span><span class=token-line style=color:#393A34><span class="token plain"> |`-._`-._    `-.__.-'    _.-'_.-'|</span><br/></span><span class=token-line style=color:#393A34><span class="token plain"> |    `-._`-._        _.-'_.-'    |           http://redis.io</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  `-._    `-._`-.__.-'_.-'    _.-'</span><br/></span><span class=token-line style=color:#393A34><span class="token plain"> |`-._`-._    `-.__.-'    _.-'_.-'|</span><br/></span><span class=token-line style=color:#393A34><span class="token plain"> |    `-._`-._        _.-'_.-'    |</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  `-._    `-._`-.__.-'_.-'    _.-'</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">      `-._    `-.__.-'    _.-'</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">          `-._        _.-'</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">              `-.__.-'</span><br/></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">25572:M 06 May 2021 07:58:52.255 # WARNING: The TCP backlog setting of 511 cannot be enforced because /proc/sys/net/core/somaxconn is set to the lower value of 128.</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">25572:M 06 May 2021 07:58:52.255 # Server initialized</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">25572:M 06 May 2021 07:58:52.255 # WARNING overcommit_memory is set to 0! Background save may fail under low memory condition. To fix this issue add 'vm.overcommit_memory = 1' to /etc/sysctl.conf and then reboot or run the command 'sysctl vm.overcommit_memory=1' for this to take effect.</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">25572:M 06 May 2021 07:58:52.255 # WARNING you have Transparent Huge Pages (THP) support enabled in your kernel. This will create latency and memory usage issues with Redis. To fix this issue run the command 'echo never > /sys/kernel/mm/transparent_hugepage/enabled' as root, and add it to your /etc/rc.local in order to retain the setting after a reboot. Redis must be restarted after THP is disabled.</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">25572:M 06 May 2021 07:58:52.255 * Ready to accept connections</span><br/></span></code></pre></div></div>
<p>出現 <strong>Ready to accept connections</strong> 後表示 Redis 程式可正常運作,
可再依需要把執行檔複製到 `/usr/local/bin' 之類系統資料夾中.</p>
<p>而警告訊息的排除可參考: [Redis 警告訊息排除](Redis Troubleshooting.md)</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id=準備-config>準備 config<a href=#準備-config class=hash-link aria-label="準備 config的直接連結" title="準備 config的直接連結" translate=no>​</a></h2>
<p>官方建議使用六個 node 來建 redis cluster,
實際業務運行上通常為六台獨立的主機, 使用同一份 config 部署到六台主機即可.</p>
<blockquote>
<p>本地測試在同一台主機上跑六個不同 redis-server instance, 分別使用 Port: 7001 ~ 7006. 因此需準備六份 config.</p>
</blockquote>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">$ mkdir 7001 7002 7003 7004 7005 7006</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">$ vi 7001/redis.config</span><br/></span></code></pre></div></div>
<div class="language-cfg codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-cfg codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">port 7001</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">cluster-enabled yes</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">cluster-config-file nodes_7001.conf</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">cluster-node-timeout 5000</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">appendonly yes</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">daemonize yes</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">bind x.x.x.x</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">requirepass password</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">masterauth password</span><br/></span></code></pre></div></div>
<p>基本需要的設置內容與簡單說明如下:</p>
<ul>
<li class=""><strong>port</strong> <em>7001</em><br/>
Redis-Server instance 所服務的 port, 相同主機的話需錯開.</li>
<li class=""><strong>cluster-enabled</strong> <em>yes</em><br/>
啟用 redis cluster</li>
<li class=""><strong>cluster-config-file</strong> <em>nodes_7001.conf</em><br/>
每個 node 需要獨立的 cluster 設定檔.
僅需指定檔名, 無須設定檔案內容.
redis-cluster 運作時會自行維護與修改該檔案內容.</li>
<li class=""><strong>cluster-node-timeout</strong> <em>5000</em><br/>
node 判斷失效的時間</li>
<li class=""><strong>appendonly</strong> <em>yes</em><br/>
啟用 aof</li>
</ul>
<p>設定檔有上述內容, 基本上就可以執行一個 redis-cluster node 了.
而一些常見的額外設定如下:</p>
<ul>
<li class=""><strong>daemonize</strong> <em>yes</em><br/>
背景執行</li>
<li class=""><strong>bind</strong> <em>x.x.x.x</em><br/>
允許 listen 特定 ip 的連線</li>
<li class=""><strong>requirepass</strong> <em>password</em><br/>
密碼設定</li>
<li class=""><strong>masterauth</strong> <em>password</em><br/>
從 master 的密碼</li>
</ul>
<p><img decoding=async loading=lazy src="https://lh3.googleusercontent.com/pw/ACtC-3cIjjFhS63ywfyKTBTR55SdYX1NTTwgKzdEjZ9LqEuyrjRM2yUSQ7nWOw_zki8AQLXzLJLjRuseunT-LcW5QTEt6Jg7D18Gf3S5B8yGy_ittXXp19pD8FCj33nBdo-pZbKl2BkLTPK0rzOo5ntxgCUoFQ=w502no?authuser=0" alt="" class=img_ev3q /></p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id=啟動>啟動<a href=#啟動 class=hash-link aria-label=啟動的直接連結 title=啟動的直接連結 translate=no>​</a></h2>
<p>透過 <code>redis-server</code> 搭配各個設定檔, 逐一啟動不同的 redis-server instance</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">$ redis-server 7001/redif.conf</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">$ redis-server 7002/redif.conf</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">$ redis-server 7003/redif.conf</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">$ redis-server 7004/redif.conf</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">$ redis-server 7005/redif.conf</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">$ redis-server 7006/redif.conf</span><br/></span></code></pre></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id=加入-cluster>加入 cluster<a href=#加入-cluster class=hash-link aria-label="加入 cluster的直接連結" title="加入 cluster的直接連結" translate=no>​</a></h2>
<p>只是把各個 redis-server instance 跑起來, 彼此尚不是 cluster 裡面的 node,
需下指令建理 cluster.</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">$ redis-cli --cluster create 127.0.0.1:7001 127.0.0.1:7002 127.0.0.1:7003 127.0.0.1:7004 127.0.0.1:7005 127.0.0.1:7006 --cluster-replicas 1</span><br/></span></code></pre></div></div>
<ul>
<li class=""><strong>redis-cli</strong><br/>
redis CLI 控制程式, 除了集成一些控制項目外, 也是個完整的 redis-client.</li>
<li class=""><strong>--cluster create</strong> <em>x.x.x.x:port1 ... x.x.x.x:port6</em><br/>
利用這些 redis-server instance 建立 redis-cluster.</li>
<li class=""><strong>--cluster-replicas</strong> <em>1</em><br/>
一個 master 節點搭配一個 slave 節點.<br/>
因上述指令共有六個節點, 所以會建構出三個 master 節點搭配三個 slave 節點.</li>
</ul>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id=see-also>See Also<a href=#see-also class=hash-link aria-label="See Also的直接連結" title="See Also的直接連結" translate=no>​</a></h2>
<p>以上是最常見的 Redis Cluster 建製方法, 也是官方建議的方案.
關於 Redis Cluster 進一步資訊, <a href="https://www.796t.com/article.php?id=192567" target=_blank rel="noopener noreferrer" class="">Redis初步學習整理——第五節Cluster叢集部署、主從複製、哨兵模式_資料庫_程式人生</a>
是個相當不錯的文章, 值得一讀.</p>
<p>其他參考資料陳列於下:</p>
<ul>
<li class=""><a href=https://redis.io/topics/cluster-tutorial target=_blank rel="noopener noreferrer" class="">Redis cluster tutorial – Redis</a></li>
<li class=""><a href=https://tw511.com/a/01/6479.html target=_blank rel="noopener noreferrer" class="">Centos 7 部署Redis 三主三從叢集 - tw511教學網</a></li>
<li class=""><a href=https://blog.yowko.com/create-redis-cluster/ target=_blank rel="noopener noreferrer" class="">建立 Redis Cluster (Redis 5) - Yowko's Notes</a></li>
<li class=""><a href=https://medium.com/@zihansyu/redis-%E9%9B%86%E7%BE%A4%E6%9E%B6%E8%A8%AD-ff641c97232c target=_blank rel="noopener noreferrer" class="">Redis 集群架設. 前言 | by 徐子函 | Medium</a></li>
</ul></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-tags-row"><div class=col><b>標籤：</b><ul class="tags_jXut padding--none margin-left--sm"><li class=tag_QGVx><a rel=tag class="tag_zVej tagRegular_sFm0" href=/moco/tags/infra/>Infra</a><li class=tag_QGVx><a rel=tag class="tag_zVej tagRegular_sFm0" href=/moco/tags/redis/>Redis</a></ul></div></div></footer></article><nav class="docusaurus-mt-lg pagination-nav" aria-label=文件選項卡><a class="pagination-nav__link pagination-nav__link--prev" href=/moco/devsecops/infra/nginx-snippets/><div class=pagination-nav__sublabel>上一頁</div><div class=pagination-nav__label>NGINX: Snippets</div></a><a class="pagination-nav__link pagination-nav__link--next" href=/moco/devsecops/infra/redis-troubleshooting/><div class=pagination-nav__sublabel>下一頁</div><div class=pagination-nav__label>Redis: 警告與問題排除</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href=#安裝-redis class="table-of-contents__link toc-highlight">安裝 Redis</a><li><a href=#準備-config class="table-of-contents__link toc-highlight">準備 config</a><li><a href=#啟動 class="table-of-contents__link toc-highlight">啟動</a><li><a href=#加入-cluster class="table-of-contents__link toc-highlight">加入 cluster</a><li><a href=#see-also class="table-of-contents__link toc-highlight">See Also</a></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="theme-layout-footer-column col footer__col"><div class=footer__title>主題索引</div><ul class="footer__items clean-list"><li class=footer__item><a class=footer__link-item href=/backpacker/lonely-planet/>Backpacker</a><li class=footer__item><a class=footer__link-item href=/lifehacker/way-2-kywk/>Lifehacker</a><li class=footer__item><a class=footer__link-item href=/moco/kywk.moco/>MoCo Lab</a></ul></div><div class="theme-layout-footer-column col footer__col"><div class=footer__title>筆記頻道</div><ul class="footer__items clean-list"><li class=footer__item><a class=footer__link-item href=/news/>News Log</a><li class=footer__item><a class=footer__link-item href=/life/>Life Blog</a></ul></div><div class="theme-layout-footer-column col footer__col"><div class=footer__title>連結</div><ul class="footer__items clean-list"><li class=footer__item><a href=https://github.com/kywk target=_blank rel="noopener noreferrer" class=footer__link-item>GitHub<svg width=13.5 height=13.5 aria-label="(opens in new tab)" class=iconExternalLink_nPIU><use href=#theme-svg-external-link /></svg></a></ul></div></div><div class="footer__bottom text--center"><div class=footer__copyright>Copyright © 2026 kywk. Built with Docusaurus.</div></div></div></footer></div></body>